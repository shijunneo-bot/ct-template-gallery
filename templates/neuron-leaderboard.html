<!DOCTYPE html>
<html lang="en">

<head>
  <script>
    const CONFIG = {
      includeDismissButton: true,

      brand: {
        name: "Neuron",
        orange: "#FF6B00",
        orangeDark: "#E85D00",
        orangeGlow: "rgba(255,107,0,0.25)",
        orangeSubtle: "rgba(255,107,0,0.08)",
        green: "#34D399",
        greenDark: "#10B981",
        greenSubtle: "rgba(52,211,153,0.08)",
        red: "#F87171",
        redSubtle: "rgba(248,113,113,0.06)",
        gold: "#FBBF24",
        surface: "#0D1117",
        card: "#161B22",
        cardRaised: "#1C2128",
        border: "rgba(255,255,255,0.06)",
        white: "#F0F4F8",
        grey: "#6B7A94",
        greyLight: "#8B95A8",
      },

      // üèÜ League config
      league: {
        // Current user's league tier
        // tiers: bronze, silver, gold, diamond, platinum
        tier: "silver",
        tierLabel: "Silver League",
        tierIcon: "ü•à",

        // Weekly reset countdown target (ISO)
        // In production, set dynamically
        resetAt: new Date(Date.now() + 3 * 24 * 60 * 60 * 1000 + 14 * 60 * 60 * 1000).toISOString(),

        // Promotion / relegation rules
        promoteTop: 10,    // top 10 promote
        relegateBottom: 5, // bottom 5 relegate
        cohortSize: 30,

        // XP metric label
        xpUnit: "Green km",
        xpIcon: "üå±",
      },

      // üë§ Current user
      currentUser: {
        id: "me",
        name: "You",
        xp: 47.2,
        rank: 13,
        avatar: null, // null = show initial
        rides: 12,
        co2Saved: "3.8 kg",
      },

      // üìã Visible cohort (show ~15 around user)
      // In production: pulled from CleverTap profile / backend API
      cohort: [
        { rank: 1,  name: "Liam T.",     xp: 128.4, badge: "üî•" },
        { rank: 2,  name: "Sophie W.",    xp: 121.1, badge: null },
        { rank: 3,  name: "Jax M.",       xp: 115.7, badge: null },
        { rank: 4,  name: "Emma R.",      xp: 104.2, badge: null },
        { rank: 5,  name: "Noah K.",      xp: 98.6,  badge: null },
        { rank: 6,  name: "Mia L.",       xp: 91.3,  badge: null },
        { rank: 7,  name: "Ethan C.",     xp: 84.9,  badge: null },
        { rank: 8,  name: "Chloe H.",     xp: 79.1,  badge: null },
        { rank: 9,  name: "Oliver P.",    xp: 72.0,  badge: null },
        { rank: 10, name: "Isla D.",      xp: 65.4,  badge: null },
        { rank: 11, name: "Ava B.",       xp: 58.7,  badge: null },
        { rank: 12, name: "Leo S.",       xp: 52.1,  badge: null },
        // rank 13 = current user (injected programmatically)
        { rank: 14, name: "Ruby F.",      xp: 44.8,  badge: null },
        { rank: 15, name: "Kai N.",       xp: 39.2,  badge: null },
        // --- gap ---
        { rank: 26, name: "Zara W.",      xp: 12.1,  badge: null },
        { rank: 27, name: "Finn J.",      xp: 9.8,   badge: null },
        { rank: 28, name: "Maya L.",      xp: 7.4,   badge: null },
        { rank: 29, name: "Riley H.",     xp: 4.1,   badge: null },
        { rank: 30, name: "Sam T.",       xp: 1.2,   badge: null },
      ],

      cta: {
        text: "Start Riding",
        url: "neuron://ride",
      },

      events: {
        leagueViewed: "League_Viewed",
        leagueCta: "League_CTA_Clicked",
        leagueDismissed: "League_Dismissed",
      },
    };
  </script>

  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>
  <title>Neuron ‚Äî Green Riders League</title>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@500;600;700&display=swap');

    *,*::before,*::after{margin:0;padding:0;box-sizing:border-box}

    html,body{
      width:100%;height:100%;
      font-family:'Outfit',sans-serif;
      background:#0D1117;
      -webkit-font-smoothing:antialiased;
      overflow:hidden;
    }

    /* =============================================
       MODAL
       ============================================= */
    .modal{
      width:100%;height:100%;
      display:flex;flex-direction:column;
      position:relative;
      background:linear-gradient(175deg,#0D1117 0%,#161B22 50%,#0D1117 100%);
    }

    .modal::before{
      content:'';position:fixed;inset:0;
      background:radial-gradient(ellipse 50% 30% at 50% 0%,rgba(255,107,0,0.06) 0%,transparent 70%);
      pointer-events:none;z-index:0;
    }

    /* =============================================
       DISMISS
       ============================================= */
    .dismiss{
      position:absolute;top:12px;right:12px;
      width:32px;height:32px;border-radius:50%;
      background:rgba(255,255,255,0.04);
      border:1px solid rgba(255,255,255,0.06);
      display:flex;align-items:center;justify-content:center;
      cursor:pointer;z-index:100;
      -webkit-tap-highlight-color:transparent;
    }
    .dismiss:active{background:rgba(255,255,255,0.08)}
    .dismiss svg{width:13px;height:13px;stroke:rgba(255,255,255,0.35);stroke-width:2}

    /* =============================================
       HEADER ‚Äî league tier + countdown
       ============================================= */
    .header{
      position:relative;z-index:1;
      padding:16px 20px 0;
      flex-shrink:0;
    }

    .tier-bar{
      display:flex;align-items:center;justify-content:space-between;
      margin-bottom:12px;
      opacity:0;animation:fadeIn .3s ease .1s forwards;
    }
    @keyframes fadeIn{to{opacity:1}}

    .tier-left{display:flex;align-items:center;gap:8px}

    .tier-icon{
      font-size:24px;line-height:1;
      animation:tierPop .5s cubic-bezier(.34,1.56,.64,1) .2s both;
    }
    @keyframes tierPop{
      from{transform:scale(0) rotate(-20deg);opacity:0}
      to{transform:scale(1) rotate(0);opacity:1}
    }

    .tier-info{}
    .tier-label{
      font-size:16px;font-weight:800;
      color:#F0F4F8;line-height:1.2;
    }
    .tier-sub{
      font-size:11px;font-weight:500;
      color:#6B7A94;
    }

    .countdown{
      display:flex;align-items:center;gap:5px;
      padding:5px 10px;
      border-radius:8px;
      background:rgba(255,255,255,0.04);
      border:1px solid rgba(255,255,255,0.06);
    }
    .countdown-icon{font-size:12px}
    .countdown-text{
      font-family:'JetBrains Mono',monospace;
      font-size:11px;font-weight:600;
      color:#8B95A8;
    }

    /* =============================================
       PROMOTION PROGRESS BAR
       ============================================= */
    .promo-section{
      padding:0 20px;
      margin-bottom:12px;
      opacity:0;animation:fadeUp .4s ease .2s forwards;
    }
    @keyframes fadeUp{
      from{opacity:0;transform:translateY(6px)}
      to{opacity:1;transform:translateY(0)}
    }

    .promo-card{
      padding:12px 14px;
      border-radius:14px;
      background:rgba(255,107,0,0.04);
      border:1px solid rgba(255,107,0,0.1);
    }

    .promo-top{
      display:flex;align-items:center;justify-content:space-between;
      margin-bottom:8px;
    }
    .promo-label{
      font-size:12px;font-weight:600;
      color:#FF6B00;
    }
    .promo-rank{
      font-size:11px;font-weight:700;
      color:#8B95A8;
    }
    .promo-rank strong{color:#F0F4F8}

    .promo-track{
      width:100%;height:5px;
      border-radius:100px;
      background:rgba(255,255,255,0.04);
      overflow:hidden;
      margin-bottom:6px;
    }
    .promo-fill{
      height:100%;border-radius:100px;
      background:linear-gradient(90deg,#FF6B00,#FBBF24);
      width:0%;
      transition:width 1.2s cubic-bezier(.16,1,.3,1) .5s;
    }

    .promo-hint{
      font-size:11px;color:#6B7A94;
      font-weight:500;
    }
    .promo-hint strong{color:#FF6B00;font-weight:700}

    /* =============================================
       ZONE LEGEND
       ============================================= */
    .zone-legend{
      display:flex;align-items:center;gap:12px;
      padding:0 20px;
      margin-bottom:8px;
      opacity:0;animation:fadeIn .3s ease .3s forwards;
    }
    .zone-item{
      display:flex;align-items:center;gap:4px;
    }
    .zone-dot{
      width:6px;height:6px;border-radius:50%;
    }
    .zone-dot.promote{background:#34D399}
    .zone-dot.safe{background:#6B7A94}
    .zone-dot.relegate{background:#F87171}
    .zone-label{
      font-size:10px;font-weight:600;
      color:#6B7A94;text-transform:uppercase;
      letter-spacing:0.3px;
    }

    /* =============================================
       LEADERBOARD LIST
       ============================================= */
    .list-container{
      flex:1;
      overflow-y:auto;overflow-x:hidden;
      -webkit-overflow-scrolling:touch;
      padding:0 12px 0 12px;
      position:relative;z-index:1;
    }

    .list-container::-webkit-scrollbar{width:3px}
    .list-container::-webkit-scrollbar-track{background:transparent}
    .list-container::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.08);border-radius:10px}

    /* Gap separator */
    .gap-sep{
      display:flex;align-items:center;gap:8px;
      padding:6px 8px;
      margin:2px 0;
    }
    .gap-line{flex:1;height:1px;background:rgba(255,255,255,0.04)}
    .gap-text{
      font-size:9px;font-weight:700;
      color:#6B7A94;text-transform:uppercase;
      letter-spacing:1px;white-space:nowrap;
    }

    /* Row */
    .row{
      display:flex;align-items:center;gap:10px;
      padding:9px 10px;
      border-radius:12px;
      margin-bottom:2px;
      transition:background .15s ease;
      position:relative;
    }

    /* Zone backgrounds */
    .row.promote{background:rgba(52,211,153,0.04)}
    .row.relegate{background:rgba(248,113,113,0.04)}

    /* Current user highlight */
    .row.me{
      background:rgba(255,107,0,0.08);
      border:1.5px solid rgba(255,107,0,0.2);
      padding:10px;
    }

    /* Rank */
    .rank{
      width:24px;
      font-family:'JetBrains Mono',monospace;
      font-size:12px;font-weight:700;
      color:#6B7A94;
      text-align:center;
      flex-shrink:0;
    }
    .row.promote .rank{color:#34D399}
    .row.relegate .rank{color:#F87171}
    .row.me .rank{color:#FF6B00}

    /* Top 3 medal */
    .rank-medal{font-size:14px}

    /* Avatar */
    .avatar{
      width:32px;height:32px;
      border-radius:50%;
      background:#1C2128;
      border:2px solid rgba(255,255,255,0.06);
      display:flex;align-items:center;justify-content:center;
      font-size:12px;font-weight:800;
      color:#8B95A8;
      flex-shrink:0;
      overflow:hidden;
    }
    .row.me .avatar{
      border-color:rgba(255,107,0,0.3);
      background:rgba(255,107,0,0.1);
      color:#FF6B00;
    }

    /* Name + badge */
    .user-info{flex:1;min-width:0}
    .user-name{
      font-size:13px;font-weight:600;
      color:#F0F4F8;
      white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
    }
    .row.me .user-name{color:#FF6B00;font-weight:700}

    .user-badge{
      font-size:10px;margin-left:4px;
    }

    /* XP */
    .xp{
      font-family:'JetBrains Mono',monospace;
      font-size:12px;font-weight:700;
      color:#8B95A8;
      white-space:nowrap;
      flex-shrink:0;
    }
    .row.me .xp{color:#FF6B00}

    .xp-unit{
      font-size:9px;font-weight:600;
      color:#6B7A94;
      margin-left:2px;
    }

    /* Zone boundary line */
    .zone-divider{
      height:1px;
      margin:4px 10px;
      position:relative;
    }
    .zone-divider.promote-line{
      background:linear-gradient(90deg,transparent,rgba(52,211,153,0.2),transparent);
    }
    .zone-divider.relegate-line{
      background:linear-gradient(90deg,transparent,rgba(248,113,113,0.2),transparent);
    }
    .zone-divider-label{
      position:absolute;right:0;top:-6px;
      font-size:8px;font-weight:700;
      text-transform:uppercase;letter-spacing:0.5px;
      padding:0 6px;
      background:#0D1117;
    }
    .zone-divider.promote-line .zone-divider-label{color:rgba(52,211,153,0.5)}
    .zone-divider.relegate-line .zone-divider-label{color:rgba(248,113,113,0.5)}

    /* =============================================
       STATS BAR ‚Äî rides + CO2
       ============================================= */
    .stats-bar{
      display:flex;gap:8px;
      padding:10px 20px;
      flex-shrink:0;
      opacity:0;animation:fadeUp .3s ease .35s forwards;
    }

    .stat{
      flex:1;
      padding:10px;
      border-radius:12px;
      background:rgba(255,255,255,0.02);
      border:1px solid rgba(255,255,255,0.04);
      text-align:center;
    }
    .stat-value{
      font-family:'JetBrains Mono',monospace;
      font-size:16px;font-weight:800;
      color:#F0F4F8;
    }
    .stat-label{
      font-size:10px;font-weight:600;
      color:#6B7A94;margin-top:2px;
    }

    /* =============================================
       CTA BUTTON
       ============================================= */
    .cta-area{
      padding:8px 20px 24px;
      flex-shrink:0;
    }
    .cta-btn{
      width:100%;padding:15px;
      border-radius:14px;border:none;
      background:#FF6B00;color:#FFFFFF;
      font-family:'Outfit',sans-serif;
      font-size:15px;font-weight:700;
      cursor:pointer;
      -webkit-tap-highlight-color:transparent;
      box-shadow:0 4px 20px rgba(255,107,0,0.2);
      transition:all .2s ease;
      letter-spacing:0.3px;
    }
    .cta-btn:active{transform:scale(.97);background:#E85D00}
  </style>
</head>

<body>
  <div class="modal">
    <!-- Dismiss -->
    <button class="dismiss" id="dismissBtn" onclick="dismiss()" aria-label="Close">
      <svg viewBox="0 0 24 24" fill="none"><path d="M18 6L6 18M6 6l12 12"/></svg>
    </button>

    <!-- Header -->
    <div class="header">
      <div class="tier-bar">
        <div class="tier-left">
          <div class="tier-icon" id="tierIcon"></div>
          <div class="tier-info">
            <div class="tier-label" id="tierLabel"></div>
            <div class="tier-sub">Weekly competition ¬∑ 30 riders</div>
          </div>
        </div>
        <div class="countdown">
          <span class="countdown-icon">‚è±</span>
          <span class="countdown-text" id="countdown">--</span>
        </div>
      </div>
    </div>

    <!-- Promotion progress -->
    <div class="promo-section">
      <div class="promo-card">
        <div class="promo-top">
          <span class="promo-label" id="promoLabel"></span>
          <span class="promo-rank">Rank <strong id="promoRank"></strong> of 30</span>
        </div>
        <div class="promo-track">
          <div class="promo-fill" id="promoFill"></div>
        </div>
        <div class="promo-hint" id="promoHint"></div>
      </div>
    </div>

    <!-- Zone legend -->
    <div class="zone-legend">
      <div class="zone-item">
        <div class="zone-dot promote"></div>
        <span class="zone-label">Promote (Top 10)</span>
      </div>
      <div class="zone-item">
        <div class="zone-dot safe"></div>
        <span class="zone-label">Safe</span>
      </div>
      <div class="zone-item">
        <div class="zone-dot relegate"></div>
        <span class="zone-label">Relegate (Bottom 5)</span>
      </div>
    </div>

    <!-- Leaderboard list -->
    <div class="list-container" id="listContainer"></div>

    <!-- Stats bar -->
    <div class="stats-bar">
      <div class="stat">
        <div class="stat-value" id="statRides"></div>
        <div class="stat-label">Rides this week</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="statCo2"></div>
        <div class="stat-label">CO√¢'' saved</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="statKm"></div>
        <div class="stat-label" id="xpUnitLabel"></div>
      </div>
    </div>

    <!-- CTA -->
    <div class="cta-area">
      <button class="cta-btn" id="ctaBtn" onclick="ctaClick()"></button>
    </div>
  </div>

  <script>
    const L = CONFIG.league;
    const ME = CONFIG.currentUser;

    // =============================================
    // TIER DISPLAY
    // =============================================
    const tierMap = {
      bronze:   { icon: "ü•â", next: "Silver",   color: "#CD7F32" },
      silver:   { icon: "ü•à", next: "Gold",      color: "#C0C0C0" },
      gold:     { icon: "ü•á", next: "Diamond",   color: "#FFD700" },
      diamond:  { icon: "üíé", next: "Platinum",  color: "#B9F2FF" },
      platinum: { icon: "üëë", next: null,        color: "#E5E4E2" },
    };

    const tier = tierMap[L.tier] || tierMap.silver;
    document.getElementById('tierIcon').textContent = L.tierIcon;
    document.getElementById('tierLabel').textContent = L.tierLabel;

    // =============================================
    // COUNTDOWN TIMER
    // =============================================
    function updateCountdown() {
      const now = Date.now();
      const end = new Date(L.resetAt).getTime();
      const diff = Math.max(0, end - now);

      const d = Math.floor(diff / (1000 * 60 * 60 * 24));
      const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));

      let text = '';
      if (d > 0) text = `${d}d ${h}h ${m}m`;
      else if (h > 0) text = `${h}h ${m}m`;
      else text = `${m}m`;

      document.getElementById('countdown').textContent = text;
    }
    updateCountdown();
    setInterval(updateCountdown, 60000);

    // =============================================
    // PROMOTION PROGRESS
    // =============================================
    (function renderPromo() {
      const rank = ME.rank;
      const promoteThreshold = L.promoteTop;
      const relegateStart = L.cohortSize - L.relegateBottom + 1;

      // Is user in promotion zone?
      const inPromo = rank <= promoteThreshold;
      const inRelegate = rank >= relegateStart;

      const promoLabel = document.getElementById('promoLabel');
      const promoHint = document.getElementById('promoHint');

      if (inPromo) {
        promoLabel.textContent = `‚úì In promotion zone`;
        promoLabel.style.color = '#34D399';
        document.querySelector('.promo-card').style.background = 'rgba(52,211,153,0.04)';
        document.querySelector('.promo-card').style.borderColor = 'rgba(52,211,153,0.1)';
        promoHint.innerHTML = `Keep riding to secure your spot in <strong style="color:#34D399">${tier.next} League</strong>`;
      } else if (inRelegate) {
        promoLabel.textContent = `√¢≈°¬† Relegation zone`;
        promoLabel.style.color = '#F87171';
        document.querySelector('.promo-card').style.background = 'rgba(248,113,113,0.04)';
        document.querySelector('.promo-card').style.borderColor = 'rgba(248,113,113,0.1)';
        const needed = CONFIG.cohort.find(u => u.rank === relegateStart - 1);
        const gap = needed ? (needed.xp - ME.xp).toFixed(1) : '?';
        promoHint.innerHTML = `<strong style="color:#F87171">${gap} ${L.xpUnit}</strong> to escape relegation`;
      } else {
        // Safe zone ‚Äî show distance to promotion
        const promoUser = CONFIG.cohort.find(u => u.rank === promoteThreshold);
        const gap = promoUser ? (promoUser.xp - ME.xp).toFixed(1) : '?';
        promoLabel.textContent = `${gap} ${L.xpUnit} to promotion`;
        promoHint.innerHTML = `Ride <strong>${gap} more km</strong> to reach <strong style="color:#FF6B00">${tier.next} League</strong>`;
      }

      document.getElementById('promoRank').textContent = `#${rank}`;

      // Progress bar: how close to promotion zone
      // 100% = rank 1, 0% = rank 30
      const pct = Math.max(0, Math.min(100, ((L.cohortSize - rank) / (L.cohortSize - 1)) * 100));
      requestAnimationFrame(() => {
        document.getElementById('promoFill').style.width = `${pct}%`;
      });
    })();

    // =============================================
    // BUILD LEADERBOARD
    // =============================================
    (function buildList() {
      const container = document.getElementById('listContainer');
      const promoteThreshold = L.promoteTop;
      const relegateStart = L.cohortSize - L.relegateBottom + 1;

      // Merge current user into cohort
      const allUsers = [...CONFIG.cohort];
      allUsers.push({
        rank: ME.rank,
        name: ME.name,
        xp: ME.xp,
        badge: null,
        isMe: true,
      });
      allUsers.sort((a, b) => a.rank - b.rank);

      let lastRank = 0;
      let addedPromoteLine = false;
      let addedRelegateLine = false;

      allUsers.forEach((user, idx) => {
        // Gap separator
        if (lastRank > 0 && user.rank - lastRank > 1) {
          const gap = document.createElement('div');
          gap.className = 'gap-sep';
          gap.innerHTML = `
            <div class="gap-line"></div>
            <span class="gap-text">Ranks ${lastRank + 1}‚Äì${user.rank - 1}</span>
            <div class="gap-line"></div>
          `;
          container.appendChild(gap);
        }

        // Promotion zone divider
        if (!addedPromoteLine && user.rank > promoteThreshold) {
          addedPromoteLine = true;
          const div = document.createElement('div');
          div.className = 'zone-divider promote-line';
          div.innerHTML = '<span class="zone-divider-label">√¢‚Äì¬≤ Promotion line</span>';
          container.appendChild(div);
        }

        // Relegation zone divider
        if (!addedRelegateLine && user.rank >= relegateStart) {
          addedRelegateLine = true;
          const div = document.createElement('div');
          div.className = 'zone-divider relegate-line';
          div.innerHTML = '<span class="zone-divider-label">√¢‚Äì¬º Relegation line</span>';
          container.appendChild(div);
        }

        // Row
        const row = document.createElement('div');
        let zone = '';
        if (user.rank <= promoteThreshold) zone = 'promote';
        else if (user.rank >= relegateStart) zone = 'relegate';

        row.className = `row ${zone} ${user.isMe ? 'me' : ''}`;
        row.style.opacity = '0';
        row.style.animation = `fadeUp .3s ease ${0.05 * Math.min(idx, 15) + 0.3}s forwards`;

        // Rank display
        let rankDisplay;
        if (user.rank === 1) rankDisplay = '<span class="rank-medal">ü•á</span>';
        else if (user.rank === 2) rankDisplay = '<span class="rank-medal">ü•à</span>';
        else if (user.rank === 3) rankDisplay = '<span class="rank-medal">ü•â</span>';
        else rankDisplay = user.rank;

        // Avatar initial
        const initial = user.isMe ? 'üõ¥' : user.name.charAt(0).toUpperCase();

        row.innerHTML = `
          <div class="rank">${rankDisplay}</div>
          <div class="avatar">${initial}</div>
          <div class="user-info">
            <span class="user-name">${user.name}${user.badge ? `<span class="user-badge">${user.badge}</span>` : ''}</span>
          </div>
          <div class="xp">${user.xp}<span class="xp-unit">km</span></div>
        `;

        container.appendChild(row);
        lastRank = user.rank;
      });

      // Scroll to current user after render
      setTimeout(() => {
        const meRow = container.querySelector('.row.me');
        if (meRow) {
          meRow.scrollIntoView({ block: 'center', behavior: 'smooth' });
        }
      }, 800);
    })();

    // =============================================
    // STATS BAR
    // =============================================
    document.getElementById('statRides').textContent = ME.rides;
    document.getElementById('statCo2').textContent = ME.co2Saved;
    document.getElementById('statKm').textContent = ME.xp;
    document.getElementById('xpUnitLabel').textContent = L.xpUnit;

    // =============================================
    // CTA
    // =============================================
    document.getElementById('ctaBtn').textContent = CONFIG.cta.text;

    window.ctaClick = function () {
      pushEvent(CONFIG.events.leagueCta, {
        League_Tier: L.tier,
        Rank: ME.rank,
        XP: ME.xp,
      });
      if (CONFIG.cta.url) window.location.href = CONFIG.cta.url;
    };

    // =============================================
    // DISMISS
    // =============================================
    if (!CONFIG.includeDismissButton) document.getElementById('dismissBtn').style.display = 'none';

    window.dismiss = function () {
      pushEvent(CONFIG.events.leagueDismissed, {
        League_Tier: L.tier,
        Rank: ME.rank,
      });
      try {
        if (typeof CleverTap !== 'undefined' && CleverTap.dismissInAppNotification) {
          CleverTap.dismissInAppNotification(); return;
        }
      } catch (e) {}
      window.location.href = 'wzrk://exit';
    };

    // =============================================
    // CLEVERTAP EVENT BRIDGE
    // =============================================
    function pushEvent(name, props) {
      const p = props || {};
      p.Timestamp = new Date().toISOString();
      try {
        if (typeof CleverTap !== 'undefined' && CleverTap.pushEvent)
          CleverTap.pushEvent(name, JSON.stringify(p));
        if (typeof clevertap !== 'undefined' && clevertap.event)
          clevertap.event.push(name, p);
        if (window.webkit?.messageHandlers?.clevertap)
          window.webkit.messageHandlers.clevertap.postMessage(
            JSON.stringify({ type: 'event', name, props: p })
          );
      } catch (e) { console.log('[CT]', name, p); }
    }

    pushEvent(CONFIG.events.leagueViewed, {
      League_Tier: L.tier,
      Rank: ME.rank,
      XP: ME.xp,
      Cohort_Size: L.cohortSize,
    });
  </script>
</body>
</html>
