<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<title>TREVO Picks</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,400;0,9..40,500;0,9..40,700;0,9..40,900&family=JetBrains+Mono:wght@500;700&display=swap');

  *{margin:0;padding:0;box-sizing:border-box}

  :root{
    --trevo:#8451F0;
    --trevo-light:#A57FF7;
    --trevo-dark:#6B3DD4;
    --trevo-glow:rgba(132,81,240,0.3);
    --accent:#FFFF1B;
    --accent-muted:#E6E619;
    --bg:#0A0C12;
    --surface:#14171F;
    --surface2:#1C2030;
    --surface3:#242838;
    --text:#FFFFFF;
    --text-dim:rgba(255,255,255,0.55);
    --text-muted:rgba(255,255,255,0.3);
    --radius:16px;
  }

  html,body{
    width:100%;height:100%;overflow:hidden;
    font-family:'DM Sans',sans-serif;
    background:var(--bg);color:var(--text);
    -webkit-tap-highlight-color:transparent;
    -webkit-font-smoothing:antialiased;
  }

  /* =============================================
     CONTAINER ‚Äî bottom-sheet style
     ============================================= */
  .app{
    width:100%;max-width:420px;height:100%;
    margin:0 auto;position:relative;
    display:flex;flex-direction:column;
    justify-content:flex-end;
    overflow:hidden;
  }

  /* Scrim backdrop */
  .scrim{
    position:absolute;inset:0;
    background:rgba(0,0,0,0.65);
    opacity:0;
    transition:opacity 0.4s ease;
    z-index:1;
  }
  .scrim.active{opacity:1;}

  /* =============================================
     BOTTOM SHEET
     ============================================= */
  .sheet{
    position:relative;z-index:10;
    background:var(--surface);
    border-radius:20px 20px 0 0;
    max-height:88vh;
    transform:translateY(100%);
    transition:transform 0.55s cubic-bezier(0.32,0.72,0,1);
    display:flex;flex-direction:column;
    overflow:hidden;
  }
  .sheet.open{transform:translateY(0);}

  /* Drag handle */
  .handle{
    width:36px;height:4px;
    background:var(--text-muted);
    border-radius:2px;
    margin:10px auto 0;
    flex-shrink:0;
  }

  /* Close button */
  .sheet-close{
    position:absolute;top:10px;right:14px;z-index:20;
    width:30px;height:30px;
    background:rgba(255,255,255,0.08);
    border:none;border-radius:50%;
    display:flex;align-items:center;justify-content:center;
    cursor:pointer;
  }
  .sheet-close svg{stroke:var(--text-dim);width:12px;height:12px;}

  /* =============================================
     PHASE 1: QUESTION
     ============================================= */
  .phase{
    display:none;
    flex-direction:column;
    opacity:0;
    transition:opacity 0.35s ease;
  }
  .phase.active{
    display:flex;
    opacity:1;
  }

  /* Hero image area (simulated) */
  .hero-preview{
    position:relative;
    width:100%;
    aspect-ratio:16/9;
    background:var(--bg);
    overflow:hidden;
    flex-shrink:0;
  }

  .hero-img{
    position:absolute;inset:0;
    background-size:cover;
    background-position:center;
    animation:slowZoom 12s ease-in-out infinite alternate;
    display:flex;align-items:center;justify-content:center;
  }

  .hero-emoji{
    font-size:52px;
    filter:drop-shadow(0 4px 20px rgba(0,0,0,0.5));
    opacity:0.6;
  }

  @keyframes slowZoom{
    0%{transform:scale(1)}
    100%{transform:scale(1.08)}
  }

  .hero-overlay{
    position:absolute;inset:0;
    background:linear-gradient(0deg,var(--surface) 0%,rgba(20,23,31,0.4) 50%,transparent 100%);
  }

  /* Video badge */
  .video-badge{
    position:absolute;top:12px;left:12px;
    display:flex;align-items:center;gap:5px;
    background:rgba(0,0,0,0.55);
    backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);
    padding:5px 10px;border-radius:20px;
    font-size:10px;font-weight:700;
    color:var(--text);letter-spacing:0.5px;
  }
  .video-badge::before{
    content:'';width:6px;height:6px;
    background:#FF4444;border-radius:50%;
    animation:livePulse 1.5s ease-in-out infinite;
  }
  @keyframes livePulse{
    0%,100%{opacity:1}50%{opacity:0.4}
  }

  /* Mute toggle */
  .mute-btn{
    position:absolute;top:12px;right:12px;
    width:32px;height:32px;
    background:rgba(0,0,0,0.55);
    backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);
    border:none;border-radius:50%;
    display:flex;align-items:center;justify-content:center;
    cursor:pointer;
  }
  .mute-btn svg{width:14px;height:14px;fill:var(--text);}

  .question-body{
    padding:16px 20px 20px;
  }

  .q-brand{
    display:flex;align-items:center;gap:8px;
    margin-bottom:12px;
  }
  .q-brand-mark{
    width:28px;height:28px;
    background:var(--trevo);
    border-radius:8px;
    display:flex;align-items:center;justify-content:center;
    font-size:10px;font-weight:900;color:#fff;
    letter-spacing:-0.3px;
  }
  .q-brand-name{
    font-size:12px;font-weight:700;color:var(--text);
  }
  .q-brand-tag{
    font-size:10px;font-weight:500;color:var(--text-dim);
  }

  .q-title{
    font-size:20px;font-weight:900;
    letter-spacing:-0.5px;
    line-height:1.2;
    margin-bottom:4px;
  }

  .q-sub{
    font-size:13px;color:var(--text-dim);
    line-height:1.4;margin-bottom:18px;
  }

  .q-options{
    display:flex;gap:10px;
  }

  .q-btn{
    flex:1;height:50px;
    border-radius:12px;
    font-family:'DM Sans',sans-serif;
    font-size:15px;font-weight:700;
    cursor:pointer;
    transition:all 0.2s ease;
    display:flex;align-items:center;justify-content:center;gap:6px;
    letter-spacing:0.2px;
  }
  .q-btn:active{transform:scale(0.96);}

  .q-yes{
    background:var(--trevo);
    border:none;color:#fff;
    box-shadow:0 4px 20px var(--trevo-glow);
  }
  .q-no{
    background:transparent;
    border:1.5px solid var(--surface3);
    color:var(--text-dim);
  }
  .q-no:hover{border-color:var(--text-muted);}

  /* =============================================
     PHASE 2: RECOMMENDATIONS
     ============================================= */
  .rec-body{
    flex:1;overflow:hidden;
    display:flex;flex-direction:column;
  }

  /* PIP video strip */
  .pip-strip{
    position:relative;
    width:100%;
    aspect-ratio:16/9;
    background:var(--bg);
    overflow:hidden;
    flex-shrink:0;
  }

  .pip-video{
    position:absolute;inset:0;
    background-size:cover;
    background-position:center;
    animation:slowZoom 12s ease-in-out infinite alternate;
    display:flex;align-items:center;justify-content:center;
  }

  .pip-emoji{
    font-size:56px;
    filter:drop-shadow(0 4px 20px rgba(0,0,0,0.5));
    opacity:0.7;
  }

  .pip-gradient{
    position:absolute;inset:0;
    background:linear-gradient(0deg,var(--surface) 0%,rgba(20,23,31,0.3) 60%,transparent 100%);
  }

  .pip-tag{
    position:absolute;bottom:12px;left:12px;
    display:inline-flex;align-items:center;gap:5px;
    background:rgba(132,81,240,0.85);
    backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);
    padding:4px 10px;border-radius:6px;
    font-size:10px;font-weight:700;color:#fff;
    letter-spacing:0.3px;
  }

  .pip-price{
    position:absolute;bottom:12px;right:12px;
    font-family:'JetBrains Mono',monospace;
    font-size:13px;font-weight:700;
    color:var(--accent);
    text-shadow:0 1px 6px rgba(0,0,0,0.5);
  }

  /* Rec content */
  .rec-content{
    padding:14px 20px 0;
    flex-shrink:0;
  }

  .rec-eyebrow{
    font-size:10px;font-weight:700;
    text-transform:uppercase;letter-spacing:1px;
    color:var(--trevo-light);
    margin-bottom:4px;
  }

  .rec-title{
    font-size:17px;font-weight:900;
    letter-spacing:-0.3px;
    line-height:1.2;
    margin-bottom:3px;
  }

  .rec-desc{
    font-size:12px;color:var(--text-dim);
    line-height:1.4;
    margin-bottom:14px;
  }

  /* Thumbnail carousel */
  .carousel-label{
    font-size:10px;font-weight:700;
    text-transform:uppercase;letter-spacing:1px;
    color:var(--text-muted);
    margin-bottom:8px;
    padding:0 20px;
    flex-shrink:0;
  }

  .carousel{
    display:flex;
    gap:10px;
    overflow-x:auto;
    overflow-y:hidden;
    padding:0 20px 14px;
    scrollbar-width:none;
    -webkit-overflow-scrolling:touch;
    flex-shrink:0;
  }
  .carousel::-webkit-scrollbar{display:none}

  .thumb{
    flex-shrink:0;
    width:110px;
    border-radius:10px;
    overflow:hidden;
    cursor:pointer;
    transition:all 0.25s ease;
    border:2px solid transparent;
    position:relative;
  }
  .thumb.selected{
    border-color:var(--trevo);
    box-shadow:0 0 16px var(--trevo-glow);
  }

  .thumb-img{
    width:100%;aspect-ratio:4/3;
    background-size:cover;
    background-position:center;
    display:flex;align-items:center;justify-content:center;
    font-size:28px;
    text-shadow:0 2px 12px rgba(0,0,0,0.4);
  }

  .thumb-info{
    background:var(--surface2);
    padding:7px 8px;
  }

  .thumb-name{
    font-size:10px;font-weight:700;
    color:var(--text);
    white-space:nowrap;overflow:hidden;
    text-overflow:ellipsis;
  }

  .thumb-meta{
    font-size:9px;font-weight:500;
    color:var(--text-muted);
    margin-top:1px;
  }

  .thumb-selected-dot{
    position:absolute;top:6px;right:6px;
    width:8px;height:8px;
    border-radius:50%;
    background:var(--trevo);
    box-shadow:0 0 8px var(--trevo-glow);
    opacity:0;
    transition:opacity 0.2s ease;
  }
  .thumb.selected .thumb-selected-dot{opacity:1;}

  /* CTA area */
  .cta-area{
    padding:0 20px 20px;
    margin-top:auto;
    flex-shrink:0;
  }

  .cta-main{
    width:100%;height:50px;
    border:none;border-radius:12px;
    font-family:'DM Sans',sans-serif;
    font-size:14px;font-weight:700;
    cursor:pointer;
    display:flex;align-items:center;justify-content:center;gap:6px;
    transition:all 0.3s ease;
    letter-spacing:0.2px;
  }
  .cta-main:active{transform:scale(0.97);}

  .cta-book{
    background:var(--trevo);color:#fff;
    box-shadow:0 4px 20px var(--trevo-glow);
  }

  .cta-reminder{
    background:var(--surface3);color:var(--text);
  }

  .cta-reminder.set{
    background:rgba(52,211,153,0.15);
    color:#34D399;
    pointer-events:none;
  }

  .cta-main svg{width:16px;height:16px;}

  .cta-secondary{
    width:100%;height:40px;
    margin-top:8px;
    border:none;border-radius:10px;
    background:transparent;
    color:var(--text-muted);
    font-family:'DM Sans',sans-serif;
    font-size:12px;font-weight:600;
    cursor:pointer;
    transition:color 0.2s ease;
  }
  .cta-secondary:active{color:var(--text-dim);}

  /* =============================================
     TRANSITIONS
     ============================================= */
  @keyframes slideUp{
    from{opacity:0;transform:translateY(24px)}
    to{opacity:1;transform:translateY(0)}
  }

  .phase.active .question-body,
  .phase.active .rec-body{
    animation:slideUp 0.4s ease both;
  }

  /* =============================================
     NOISE GRAIN
     ============================================= */
  .app::after{
    content:'';position:fixed;inset:0;z-index:100;
    pointer-events:none;opacity:0.02;
    background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  }
</style>
</head>
<body>

<div class="app">
  <!-- SCRIM -->
  <div class="scrim" id="scrim"></div>

  <!-- BOTTOM SHEET -->
  <div class="sheet" id="sheet">
    <div class="handle"></div>
    <button class="sheet-close" onclick="dismiss()" aria-label="Close">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2.5" stroke-linecap="round"><path d="M18 6L6 18M6 6l12 12"/></svg>
    </button>

    <!-- PHASE 1: QUESTION -->
    <div class="phase" id="phaseQuestion">
      <div class="hero-preview">
        <div class="hero-img" id="heroImg"></div>
        <div class="hero-overlay"></div>
        <div class="video-badge">PREVIEW</div>
        <button class="mute-btn" id="muteBtn" onclick="toggleMute()" aria-label="Toggle sound">
          <svg viewBox="0 0 24 24" id="muteIcon"><path d="M11 5L6 9H2v6h4l5 4V5zM15.54 8.46a5 5 0 010 7.07M19.07 4.93a10 10 0 010 14.14"/></svg>
        </button>
      </div>
      <div class="question-body">
        <div class="q-brand">
          <div class="q-brand-mark">T</div>
          <div>
            <div class="q-brand-name">TREVO Malaysia</div>
            <div class="q-brand-tag">Car Sharing Done Right</div>
          </div>
        </div>
        <div class="q-title" id="qTitle"></div>
        <div class="q-sub" id="qSub"></div>
        <div class="q-options">
          <button class="q-btn q-yes" onclick="answer('yes')">Yes, I have! üöó</button>
          <button class="q-btn q-no" onclick="answer('no')">Not yet</button>
        </div>
      </div>
    </div>

    <!-- PHASE 2: RECOMMENDATIONS -->
    <div class="phase" id="phaseRec">
      <div class="rec-body">
        <div class="pip-strip">
          <div class="pip-video" id="pipVideo"></div>
          <div class="pip-gradient"></div>
          <div class="video-badge">PREVIEW</div>
          <button class="mute-btn" onclick="toggleMute()" aria-label="Toggle sound">
            <svg viewBox="0 0 24 24"><path d="M11 5L6 9H2v6h4l5 4V5zM15.54 8.46a5 5 0 010 7.07"/></svg>
          </button>
          <div class="pip-tag" id="pipTag"></div>
          <div class="pip-price" id="pipPrice"></div>
        </div>
        <div class="rec-content">
          <div class="rec-eyebrow" id="recEyebrow"></div>
          <div class="rec-title" id="recTitle"></div>
          <div class="rec-desc" id="recDesc"></div>
        </div>
        <div class="carousel-label">More rides for you</div>
        <div class="carousel" id="carousel"></div>
        <div class="cta-area">
          <button class="cta-main" id="ctaMain" onclick="ctaClick()"></button>
          <button class="cta-secondary" onclick="dismiss()">Maybe later</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// =============================================
// CONFIG
// =============================================
const CONFIG = {
  question: {
    hero: 'linear-gradient(135deg,#1a1030 0%,#2d1b69 40%,#4a2c8a 100%)',
    title: 'Ever taken a luxury ride?',
    subtitle: 'BMW, Mercedes, even a Tesla ‚Äî all from RM199/day on TREVO. No deposits, no queues.',
  },

  branches: {
    yes: {
      eyebrow: 'Since you have great taste‚Ä¶',
      title: 'Here are premium rides near you',
      description: 'Handpicked luxury & sports cars available this weekend in KL.',
      featured: 0,
      cars: [
        {
          id: 'bmw5',
          name: 'BMW 520i M Sport',
          type: 'Luxury Sedan',
          emoji: 'üèéÔ∏è',
          price: 'RM299/day',
          tag: 'Most Popular',
          color: '#1E3A5F',
          gradient: 'linear-gradient(135deg,#0f1923 0%,#1a3352 40%,#264a73 100%)',
          cta: 'book',
          ctaText: 'Book This Weekend',
          deeplink: 'trevo://car/bmw-520i'
        },
        {
          id: 'merc',
          name: 'Mercedes C200',
          type: 'Luxury Sedan',
          emoji: '‚ú®',
          price: 'RM279/day',
          tag: 'Top Rated',
          color: '#2D2D2D',
          gradient: 'linear-gradient(135deg,#111 0%,#222 40%,#333 100%)',
          cta: 'book',
          ctaText: 'Book Now',
          deeplink: 'trevo://car/mercedes-c200'
        },
        {
          id: 'tesla3',
          name: 'Tesla Model 3',
          type: 'Electric',
          emoji: '√¢≈°¬°',
          price: 'RM349/day',
          tag: 'Electric √¢≈°¬°',
          color: '#1a2e1a',
          gradient: 'linear-gradient(135deg,#0d1a0d 0%,#1a331a 40%,#2d4d2d 100%)',
          cta: 'book',
          ctaText: 'Book Now',
          deeplink: 'trevo://car/tesla-model-3'
        },
        {
          id: 'minicooper',
          name: 'Mini Cooper S',
          type: 'Hot Hatch',
          emoji: 'üî¥',
          price: 'RM199/day',
          tag: 'Fun Drive',
          color: '#4a2020',
          gradient: 'linear-gradient(135deg,#1a0d0d 0%,#3d1a1a 40%,#5c2e2e 100%)',
          cta: 'book',
          ctaText: 'Book Now',
          deeplink: 'trevo://car/mini-cooper-s'
        },
      ]
    },
    no: {
      eyebrow: 'Your first luxury drive awaits',
      title: 'Try a BMW 520i this weekend',
      description: 'No deposit, full insurance, keyless handover. Drive your dream car from RM299/day.',
      featured: 0,
      cars: [
        {
          id: 'bmw5',
          name: 'BMW 520i M Sport',
          type: 'Luxury Sedan',
          emoji: 'üèéÔ∏è',
          price: 'RM299/day',
          tag: 'Editor\'s Pick',
          color: '#1E3A5F',
          gradient: 'linear-gradient(135deg,#0f1923 0%,#1a3352 40%,#264a73 100%)',
          cta: 'book',
          ctaText: 'Book Your First Ride',
          deeplink: 'trevo://car/bmw-520i'
        },
        {
          id: 'myvi',
          name: 'Perodua Myvi',
          type: 'Compact',
          emoji: 'üöô',
          price: 'RM55/day',
          tag: 'Budget Friendly',
          color: '#2a2a1a',
          gradient: 'linear-gradient(135deg,#151510 0%,#2a2a1a 40%,#3d3d28 100%)',
          cta: 'book',
          ctaText: 'Book Now',
          deeplink: 'trevo://car/perodua-myvi'
        },
        {
          id: 'civic',
          name: 'Honda Civic',
          type: 'Sedan',
          emoji: 'üöó',
          price: 'RM129/day',
          tag: 'Reliable',
          color: '#1a2233',
          gradient: 'linear-gradient(135deg,#0d1119 0%,#1a2233 40%,#283348 100%)',
          cta: 'book',
          ctaText: 'Book Now',
          deeplink: 'trevo://car/honda-civic'
        },
        {
          id: 'x50',
          name: 'Proton X50',
          type: 'SUV',
          emoji: 'üõª',
          price: 'RM109/day',
          tag: 'Coming Soon',
          color: '#1a1a2e',
          gradient: 'linear-gradient(135deg,#0d0d1a 0%,#1a1a30 40%,#28284a 100%)',
          cta: 'reminder',
          ctaText: 'Set Reminder',
          deeplink: 'trevo://car/proton-x50'
        },
      ]
    }
  },

  event: 'TREVO_PIP'
};

// =============================================
// STATE
// =============================================
let userAnswer = null;
let selectedCar = null;
let branch = null;
let reminderStatus = {};
let isMuted = true;

// =============================================
// INIT
// =============================================
function init() {
  // Set question content
  document.getElementById('qTitle').textContent = CONFIG.question.title;
  document.getElementById('qSub').textContent = CONFIG.question.subtitle;
  document.getElementById('heroImg').style.background = CONFIG.question.hero;
  document.getElementById('heroImg').style.backgroundSize = 'cover';
  document.getElementById('heroImg').innerHTML = '<div class="hero-emoji">üöò</div>';

  // Animate sheet in
  requestAnimationFrame(() => {
    document.getElementById('scrim').classList.add('active');
    setTimeout(() => {
      document.getElementById('sheet').classList.add('open');
      document.getElementById('phaseQuestion').classList.add('active');
    }, 100);
  });

  trackEvent('Shown', {});
}

// =============================================
// ANSWER HANDLER
// =============================================
function answer(choice) {
  userAnswer = choice;
  branch = CONFIG.branches[choice];
  selectedCar = branch.cars[branch.featured];

  trackEvent('Answered', {
    Answer: choice,
    Featured_Car: selectedCar.name
  });

  // Transition phases
  const q = document.getElementById('phaseQuestion');
  q.style.opacity = '0';

  setTimeout(() => {
    q.classList.remove('active');
    showRecommendations();
  }, 300);
}

// =============================================
// RECOMMENDATIONS VIEW
// =============================================
function showRecommendations() {
  const phase = document.getElementById('phaseRec');

  // Set featured content
  updateFeatured(selectedCar);

  // Set eyebrow + description
  document.getElementById('recEyebrow').textContent = branch.eyebrow;
  document.getElementById('recDesc').textContent = branch.description;

  // Build carousel
  buildCarousel();

  // Show
  phase.classList.add('active');
}

function updateFeatured(car) {
  const pip = document.getElementById('pipVideo');
  pip.style.background = car.gradient;
  pip.style.backgroundSize = 'cover';
  pip.innerHTML = `<div class="pip-emoji">${car.emoji}</div>`;
  document.getElementById('pipTag').textContent = car.tag;
  document.getElementById('pipPrice').textContent = car.price;
  document.getElementById('recTitle').textContent = car.name;

  // CTA
  const btn = document.getElementById('ctaMain');
  btn.className = 'cta-main';

  if (car.cta === 'reminder') {
    if (reminderStatus[car.id]) {
      btn.classList.add('cta-reminder', 'set');
      btn.innerHTML = `
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M20 6L9 17l-5-5"/></svg>
        Reminder Set
      `;
    } else {
      btn.classList.add('cta-reminder');
      btn.innerHTML = `
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 01-3.46 0"/></svg>
        ${car.ctaText}
      `;
    }
  } else {
    btn.classList.add('cta-book');
    btn.innerHTML = car.ctaText + ' ‚Üí';
  }

  selectedCar = car;
}

function buildCarousel() {
  const carousel = document.getElementById('carousel');
  carousel.innerHTML = '';

  branch.cars.forEach((car, i) => {
    const thumb = document.createElement('div');
    thumb.className = 'thumb' + (car.id === selectedCar.id ? ' selected' : '');
    thumb.innerHTML = `
      <div class="thumb-img" style="background:${car.gradient};background-size:cover;">${car.emoji}</div>
      <div class="thumb-info">
        <div class="thumb-name">${car.name}</div>
        <div class="thumb-meta">${car.type} ¬∑ ${car.price}</div>
      </div>
      <div class="thumb-selected-dot"></div>
    `;

    thumb.addEventListener('click', () => {
      selectCar(car, thumb);
    });

    carousel.appendChild(thumb);
  });
}

function selectCar(car, thumbEl) {
  if (car.id === selectedCar.id) return;

  // Deselect all thumbs
  document.querySelectorAll('.thumb').forEach(t => t.classList.remove('selected'));
  thumbEl.classList.add('selected');

  // Update featured
  updateFeatured(car);

  trackEvent('Content_Selected', {
    Car_ID: car.id,
    Car_Name: car.name,
    Car_Type: car.type,
    Price: car.price
  });
}

// =============================================
// CTA
// =============================================
function ctaClick() {
  const car = selectedCar;

  if (car.cta === 'reminder' && !reminderStatus[car.id]) {
    // Set reminder
    reminderStatus[car.id] = true;
    const btn = document.getElementById('ctaMain');
    btn.classList.add('set');
    btn.innerHTML = `
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M20 6L9 17l-5-5"/></svg>
      Reminder Set
    `;

    trackEvent('Reminder_Set', {
      Car_ID: car.id,
      Car_Name: car.name,
      Answer: userAnswer
    });

    if (typeof CleverTap !== 'undefined') {
      CleverTap.profile.push({ Site: {
        PIP_Reminder_Car: car.name,
        PIP_Reminder_Set: true
      }});
    }
  } else if (car.cta === 'book') {
    trackEvent('CTA_Clicked', {
      Car_ID: car.id,
      Car_Name: car.name,
      CTA_Type: 'book',
      Price: car.price,
      Answer: userAnswer,
      Destination: car.deeplink
    });

    if (typeof CleverTap !== 'undefined') {
      CleverTap.profile.push({ Site: {
        PIP_Response: userAnswer,
        PIP_Last_Car_Viewed: car.name
      }});
    }

    setTimeout(() => {
      window.location.href = car.deeplink;
    }, 200);
  }
}

// =============================================
// MUTE TOGGLE (pattern only ‚Äî no real audio)
// =============================================
function toggleMute() {
  isMuted = !isMuted;
  // In production, this would control <video> muted property
  // Visual feedback only for demo
}

// =============================================
// CLEVERTAP
// =============================================
function trackEvent(action, props) {
  const eventName = CONFIG.event + '_' + action;
  console.log('[CT]', eventName, props);
  if (typeof CleverTap !== 'undefined') {
    CleverTap.event.push(eventName, props);
  }
}

// =============================================
// DISMISS
// =============================================
function dismiss() {
  trackEvent('Dismissed', {
    Phase: userAnswer ? 'recommendations' : 'question',
    Answer: userAnswer,
    Last_Car_Viewed: selectedCar ? selectedCar.name : null
  });

  document.getElementById('sheet').classList.remove('open');
  document.getElementById('scrim').classList.remove('active');
}

// =============================================
// START
// =============================================
init();
</script>

</body>
</html>
