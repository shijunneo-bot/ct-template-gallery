<!DOCTYPE html>
<html lang="en">
<head>
  <script>
    const CONFIG = {
      includeDismissButton: false, // toast has its own dismiss

      brand: {
        name: "Trevo",
        primary: "#10B981",
        primaryLight: "#34D399",
        dark: "#0A0A0A",
        text: "#FFFFFF",
      },

      toast: {
        position: "top",  // "top" or "bottom"
        style: "glass",    // "glass" or "solid"
        autoDismissSeconds: 6,
        swipeToDismiss: true,
      },

      notification: {
        type: "success", // success, info, warning, alert, promo
        emoji: "üöó",
        title: "Your Trevo is confirmed!",
        body: "Honda Jazz ¬∑ Tomorrow 8:00 AM ¬∑ Subang Jaya pickup",
        showTimestamp: true,
        timestamp: "Just now",
      },

      action: {
        show: true,
        text: "View Booking",
        url: "trevo://booking/TRV-28491",
      },

      // Additional toast variants to demo (rendered as separate toasts if enabled)
      multiToast: false,
      variants: [
        {
          type: "info",
          emoji: "üìç",
          title: "Driver is nearby",
          body: "Your host is 5 min away from the pickup point",
          timestamp: "2m ago",
          action: { show: true, text: "Track", url: "trevo://track" },
        },
        {
          type: "promo",
          emoji: "üéÅ",
          title: "Weekend deal unlocked!",
          body: "25% off any weekend booking ¬∑ Use code WKND25",
          timestamp: "5m ago",
          action: { show: true, text: "Apply", url: "trevo://promo/WKND25" },
        },
      ],

      events: {
        toastViewed:    "ToastCard_Viewed",
        toastAction:    "ToastCard_Action_Clicked",
        toastDismissed: "ToastCard_Dismissed",
        toastSwiped:    "ToastCard_Swiped",
      },
    };
  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700;800&display=swap">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    :root{
      --primary:#10B981;--primary-light:#34D399;
      --dark:#0A0A0A;--text:#FFF;--text-muted:rgba(255,255,255,.45);
    }
    body{
      background:rgba(0,0,0,.4);min-height:100vh;
      display:flex;flex-direction:column;
      font-family:'DM Sans',sans-serif;color:var(--text);
      padding:0;overflow:hidden;
    }

    /* Tap-through backdrop ‚Äî click outside dismisses */
    .backdrop{
      position:fixed;inset:0;z-index:0;
    }

    /* Toast stack */
    .toast-stack{
      position:fixed;left:12px;right:12px;z-index:10;
      display:flex;flex-direction:column;gap:8px;
    }
    .toast-stack.top{top:12px}
    .toast-stack.bottom{bottom:12px}

    /* Toast card */
    .toast{
      border-radius:18px;
      padding:16px;
      position:relative;overflow:hidden;
      transform:translateY(var(--entry-dir,-20px));
      opacity:0;
      animation:toastIn .4s cubic-bezier(.16,1,.3,1) forwards;
      touch-action:pan-x;
      transition:transform .2s ease;
    }
    .toast.glass{
      background:rgba(20,20,28,.85);
      backdrop-filter:blur(24px);-webkit-backdrop-filter:blur(24px);
      border:1px solid rgba(255,255,255,.08);
    }
    .toast.solid{
      background:#1A1A24;
      border:1px solid rgba(255,255,255,.06);
    }
    /* Top highlight */
    .toast::before{
      content:'';position:absolute;top:0;left:15%;right:15%;height:1px;
      background:linear-gradient(90deg,transparent,rgba(255,255,255,.1),transparent);
    }

    @keyframes toastIn{to{opacity:1;transform:translateY(0)}}
    @keyframes toastOut{to{opacity:0;transform:translateY(var(--exit-dir,-20px)) scale(.95)}}

    .toast.exit{animation:toastOut .3s ease forwards}
    .toast.swipe-exit{transition:transform .25s ease,opacity .25s ease}

    /* Type indicator stripe */
    .toast-stripe{
      position:absolute;top:12px;bottom:12px;left:0;width:3px;
      border-radius:0 3px 3px 0;
    }
    .toast-stripe.success{background:var(--primary)}
    .toast-stripe.info{background:#3B82F6}
    .toast-stripe.warning{background:#F59E0B}
    .toast-stripe.alert{background:#EF4444}
    .toast-stripe.promo{background:#8B5CF6}

    .toast-content{display:flex;gap:12px;align-items:flex-start;padding-left:8px}

    .toast-icon{
      width:40px;height:40px;border-radius:12px;
      display:flex;align-items:center;justify-content:center;
      font-size:22px;flex-shrink:0;
    }
    .toast-icon.success{background:rgba(16,185,129,.12)}
    .toast-icon.info{background:rgba(59,130,246,.12)}
    .toast-icon.warning{background:rgba(245,158,11,.12)}
    .toast-icon.alert{background:rgba(239,68,68,.12)}
    .toast-icon.promo{background:rgba(139,92,246,.12)}

    .toast-body{flex:1;min-width:0}
    .toast-title{font-size:14px;font-weight:800;line-height:1.3;margin-bottom:2px}
    .toast-desc{font-size:12px;color:var(--text-muted);line-height:1.4}

    .toast-meta{
      display:flex;align-items:center;justify-content:space-between;
      margin-top:10px;padding-left:8px;
    }
    .toast-time{font-size:10px;color:rgba(255,255,255,.25)}
    .toast-action{
      padding:8px 16px;border-radius:10px;border:none;
      font-family:'DM Sans',sans-serif;font-size:12px;font-weight:700;
      cursor:pointer;transition:transform .2s;
    }
    .toast-action:active{transform:scale(.95)}
    .toast-action.success{background:rgba(16,185,129,.15);color:var(--primary-light)}
    .toast-action.info{background:rgba(59,130,246,.15);color:#60A5FA}
    .toast-action.warning{background:rgba(245,158,11,.15);color:#FBBF24}
    .toast-action.alert{background:rgba(239,68,68,.15);color:#F87171}
    .toast-action.promo{background:rgba(139,92,246,.15);color:#A78BFA}

    /* Close X */
    .toast-close{
      position:absolute;top:8px;right:8px;
      width:24px;height:24px;border-radius:50%;border:none;
      background:rgba(255,255,255,.06);color:rgba(255,255,255,.3);
      font-size:12px;cursor:pointer;
      display:flex;align-items:center;justify-content:center;
    }
    .toast-close:active{transform:scale(.9)}

    /* Auto-dismiss progress */
    .toast-progress{
      position:absolute;bottom:0;left:0;right:0;height:2px;
    }
    .toast-progress-bar{
      height:100%;border-radius:0 0 18px 18px;
      width:100%;transform-origin:left;
    }
    .toast-progress-bar.success{background:var(--primary)}
    .toast-progress-bar.info{background:#3B82F6}
    .toast-progress-bar.warning{background:#F59E0B}
    .toast-progress-bar.alert{background:#EF4444}
    .toast-progress-bar.promo{background:#8B5CF6}
  </style>
</head>
<body>
  <div class="backdrop" id="backdrop"></div>
  <div class="toast-stack" id="toastStack"></div>

  <script>
    function fireEvent(n,p){try{if(window.CleverTap)window.CleverTap.pushEvent(n,p||{});else if(window.webkit?.messageHandlers?.clevertap)window.webkit.messageHandlers.clevertap.postMessage(JSON.stringify({event:n,properties:p||{}}));else if(window.clevertap)window.clevertap.event.push(n,p||{})}catch(e){console.log("CT:",n,p)}}
    function exitAll(){try{location.href="wzrk://exit"}catch(e){}}

    const stack=document.getElementById("toastStack");
    const isTop=CONFIG.toast.position==="top";
    stack.classList.add(isTop?"top":"bottom");
    const entryDir=isTop?"-20px":"20px";
    const exitDir=isTop?"-20px":"20px";

    // Tap backdrop to dismiss all
    document.getElementById("backdrop").addEventListener("click",()=>{
      document.querySelectorAll(".toast").forEach(t=>{
        t.style.setProperty("--exit-dir",exitDir);
        t.classList.add("exit");
      });
      setTimeout(exitAll,400);
    });

    function createToast(data,index){
      const el=document.createElement("div");
      el.className=`toast ${CONFIG.toast.style}`;
      el.style.setProperty("--entry-dir",entryDir);
      el.style.animationDelay=(index*0.12)+"s";

      const type=data.type||"info";

      let metaHtml="";
      if(data.timestamp||data.action?.show){
        metaHtml=`<div class="toast-meta">`;
        metaHtml+=data.timestamp?`<span class="toast-time">${data.timestamp}</span>`:`<span></span>`;
        if(data.action?.show){
          metaHtml+=`<button class="toast-action ${type}" data-url="${data.action.url||""}">${data.action.text}</button>`;
        }
        metaHtml+=`</div>`;
      }

      el.innerHTML=`
        <div class="toast-stripe ${type}"></div>
        <button class="toast-close">‚úï</button>
        <div class="toast-content">
          <div class="toast-icon ${type}">${data.emoji}</div>
          <div class="toast-body">
            <div class="toast-title">${data.title}</div>
            <div class="toast-desc">${data.body}</div>
          </div>
        </div>
        ${metaHtml}
        <div class="toast-progress"><div class="toast-progress-bar ${type}" id="bar${index}"></div></div>
      `;

      // Close button
      el.querySelector(".toast-close").addEventListener("click",(e)=>{
        e.stopPropagation();
        dismissToast(el,data.title);
      });

      // Action button
      const actionBtn=el.querySelector(".toast-action");
      if(actionBtn){
        actionBtn.addEventListener("click",(e)=>{
          e.stopPropagation();
          fireEvent(CONFIG.events.toastAction,{title:data.title,action:data.action?.text});
          if(data.action?.url)location.href=data.action.url;
        });
      }

      // Swipe to dismiss
      if(CONFIG.toast.swipeToDismiss){
        let startX=0,startY=0,dx=0;
        el.addEventListener("touchstart",(e)=>{
          startX=e.touches[0].clientX;
          startY=e.touches[0].clientY;
          dx=0;
          el.style.transition="none";
        },{passive:true});
        el.addEventListener("touchmove",(e)=>{
          dx=e.touches[0].clientX-startX;
          const dy=e.touches[0].clientY-startY;
          if(Math.abs(dx)>Math.abs(dy)&&Math.abs(dx)>10){
            el.style.transform=`translateX(${dx}px)`;
            el.style.opacity=Math.max(0,1-Math.abs(dx)/200);
          }
        },{passive:true});
        el.addEventListener("touchend",()=>{
          if(Math.abs(dx)>80){
            el.classList.add("swipe-exit");
            el.style.transform=`translateX(${dx>0?300:-300}px)`;
            el.style.opacity="0";
            fireEvent(CONFIG.events.toastSwiped,{title:data.title,direction:dx>0?"right":"left"});
            setTimeout(()=>{el.remove();checkEmpty()},300);
          }else{
            el.style.transition="transform .25s ease, opacity .25s ease";
            el.style.transform="translateX(0)";
            el.style.opacity="1";
          }
        });
      }

      stack.appendChild(el);

      // Auto-dismiss progress bar
      const dur=CONFIG.toast.autoDismissSeconds;
      if(dur>0){
        const bar=el.querySelector(`#bar${index}`);
        const delay=index*120+400;
        setTimeout(()=>{
          bar.style.transition=`transform ${dur}s linear`;
          bar.style.transform="scaleX(0)";
        },delay);
        setTimeout(()=>dismissToast(el,data.title),(dur*1000)+delay);
      }

      fireEvent(CONFIG.events.toastViewed,{title:data.title,type});
    }

    function dismissToast(el,title){
      if(el.classList.contains("exit"))return;
      el.style.setProperty("--exit-dir",exitDir);
      el.classList.add("exit");
      fireEvent(CONFIG.events.toastDismissed,{title});
      setTimeout(()=>{el.remove();checkEmpty()},350);
    }

    function checkEmpty(){
      if(stack.children.length===0)exitAll();
    }

    // Init
    (function init(){
      // Primary notification
      const primary={
        type:CONFIG.notification.type,
        emoji:CONFIG.notification.emoji,
        title:CONFIG.notification.title,
        body:CONFIG.notification.body,
        timestamp:CONFIG.notification.showTimestamp?CONFIG.notification.timestamp:null,
        action:CONFIG.action,
      };
      createToast(primary,0);

      // Additional variants
      if(CONFIG.multiToast){
        CONFIG.variants.forEach((v,i)=>setTimeout(()=>createToast(v,i+1),(i+1)*600));
      }
    })();
  </script>
</body>
</html>
