<!DOCTYPE html>
<html lang="en">

<head>
  <script>
    const CONFIG = {
      includeDismissButton: true,

      brand: {
        name: "BondbloX",
        tagline: "Bond investing, simplified.",
        cyan: "#22D3EE",
        cyanDark: "#0891B2",
        cyanDeep: "#164E63",
        cyanLight: "#CFFAFE",
        green: "#10B981",
        greenLight: "#D1FAE5",
        red: "#F87171",
        redLight: "#FEE2E2",
        amber: "#F59E0B",
        dark: "#0A0D14",
        card: "#111827",
        cardLight: "#1F2937",
        white: "#FFFFFF",
        grey: "#6B7280",
      },

      // ðŸ“Š Slider definitions
      sliders: {
        investAmount: {
          label: "Bond investment amount",
          unit: "USD",
          min: 1000,
          max: 500000,
          step: 1000,
          default: 50000,
          format: "currency",
        },
        tradesPerYear: {
          label: "Trades per year",
          unit: "trades",
          min: 1,
          max: 24,
          step: 1,
          default: 6,
          format: "integer",
        },
        avgYield: {
          label: "Average bond yield",
          unit: "%",
          min: 2.0,
          max: 10.0,
          step: 0.25,
          default: 5.5,
          format: "percent",
        },
      },

      // ðŸ’° Fee models
      fees: {
        bank: {
          label: "Private Bank",
          tradeFee: 0.01,           // 1% markup per trade (typical)
          custodyFee: 0.0025,       // 0.25% annual custody
          minInvestment: 200000,    // $200K minimum
        },
        bondblox: {
          label: "BondbloX",
          tradeFee: 0.002,          // 0.2% per trade
          custodyFee: 0.002,        // 0.2% annual AUM
          minInvestment: 1000,      // $1K minimum
        },
      },

      cta: {
        text: "Start Investing on BondbloX",
        url: "bondblox://onboard",
      },

      events: {
        calcViewed:     "Bond_Calc_Viewed",
        calcInteracted: "Bond_Calc_Interacted",
        calcCompleted:  "Bond_Calc_Completed",
        calcCta:        "Bond_Calc_CTA",
        calcDismissed:  "Bond_Calc_Dismissed",
      },
    };
  </script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>BondbloX â€” Savings Calculator</title>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');

    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    html, body {
      width: 100%; height: 100%;
      font-family: 'Inter', -apple-system, sans-serif;
      -webkit-font-smoothing: antialiased;
      overflow: hidden;
      background: #0A0D14;
    }

    .modal {
      width: 100%; height: 100%;
      display: flex; flex-direction: column;
      align-items: center;
      padding: 16px 16px 20px;
      position: relative; overflow-y: auto; overflow-x: hidden;
      background: linear-gradient(170deg, #0A0D14 0%, #0F1624 35%, #0A0D14 100%);
      -webkit-overflow-scrolling: touch;
    }

    .modal::before {
      content: '';
      position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background:
        radial-gradient(circle at 50% 10%, rgba(34,211,238,0.05) 0%, transparent 50%),
        radial-gradient(circle at 30% 90%, rgba(16,185,129,0.03) 0%, transparent 40%);
      pointer-events: none; z-index: 0;
    }

    .dismiss-btn {
      position: fixed; top: 12px; right: 12px;
      width: 30px; height: 30px; border-radius: 50%;
      background: rgba(255,255,255,0.06); border: none;
      color: rgba(255,255,255,0.4); font-size: 14px;
      cursor: pointer; z-index: 100;
      display: flex; align-items: center; justify-content: center;
      -webkit-tap-highlight-color: transparent;
    }

    .content {
      position: relative; z-index: 1;
      width: 100%; max-width: 380px;
      display: flex; flex-direction: column;
      align-items: center;
    }

    /* =============================================
       HEADER
       ============================================= */
    .header {
      text-align: center;
      margin-bottom: 18px;
      animation: fadeUp 0.4s ease forwards;
    }
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(8px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .brand-tag {
      font-size: 10px; font-weight: 700;
      color: #22D3EE;
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 6px;
    }

    .header-title {
      font-size: 20px; font-weight: 800;
      color: #FFFFFF;
      line-height: 1.25; margin-bottom: 4px;
    }
    .header-sub {
      font-size: 11px; color: rgba(255,255,255,0.35);
      line-height: 1.4;
    }

    /* =============================================
       SLIDERS
       ============================================= */
    .sliders-section {
      width: 100%;
      display: flex; flex-direction: column; gap: 10px;
      margin-bottom: 16px;
    }

    .slider-card {
      background: rgba(255,255,255,0.03);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 16px;
      padding: 14px 16px 16px;
      opacity: 0;
      animation: fadeUp 0.4s ease forwards;
    }
    .slider-card:nth-child(1) { animation-delay: 0.1s; }
    .slider-card:nth-child(2) { animation-delay: 0.2s; }
    .slider-card:nth-child(3) { animation-delay: 0.3s; }

    .sl-header {
      display: flex; justify-content: space-between;
      align-items: baseline;
      margin-bottom: 10px;
    }
    .sl-label {
      font-size: 11px; font-weight: 600;
      color: rgba(255,255,255,0.4);
    }
    .sl-value {
      font-size: 18px; font-weight: 800;
      color: #22D3EE;
      transition: all 0.15s ease;
    }

    /* Custom range slider */
    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      width: 100%; height: 6px;
      background: rgba(255,255,255,0.06);
      border-radius: 100px;
      outline: none;
      cursor: pointer;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 24px; height: 24px;
      border-radius: 50%;
      background: #22D3EE;
      box-shadow: 0 2px 8px rgba(34,211,238,0.4), 0 0 0 4px rgba(34,211,238,0.1);
      cursor: pointer;
      transition: box-shadow 0.2s ease;
    }
    input[type="range"]::-webkit-slider-thumb:active {
      box-shadow: 0 2px 12px rgba(34,211,238,0.6), 0 0 0 6px rgba(34,211,238,0.15);
    }
    input[type="range"]::-moz-range-thumb {
      width: 24px; height: 24px;
      border-radius: 50%; border: none;
      background: #22D3EE;
      box-shadow: 0 2px 8px rgba(34,211,238,0.4);
      cursor: pointer;
    }

    .sl-range-labels {
      display: flex; justify-content: space-between;
      margin-top: 4px;
    }
    .sl-min, .sl-max {
      font-size: 9px; font-weight: 600;
      color: rgba(255,255,255,0.15);
    }

    /* =============================================
       RESULTS SECTION
       ============================================= */
    .results-section {
      width: 100%;
      margin-bottom: 14px;
      opacity: 0;
      animation: fadeUp 0.4s ease 0.4s forwards;
    }

    /* Comparison cards */
    .compare-row {
      display: flex; gap: 8px;
      margin-bottom: 10px;
    }

    .compare-card {
      flex: 1;
      border-radius: 14px;
      padding: 14px 12px;
      text-align: center;
    }
    .compare-card.bank {
      background: rgba(248,113,113,0.06);
      border: 1px solid rgba(248,113,113,0.12);
    }
    .compare-card.bbx {
      background: rgba(34,211,238,0.06);
      border: 1px solid rgba(34,211,238,0.15);
    }

    .cc-label {
      font-size: 9px; font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 6px;
    }
    .cc-label.bank { color: #F87171; }
    .cc-label.bbx { color: #22D3EE; }

    .cc-total {
      font-size: 22px; font-weight: 900;
      line-height: 1;
      margin-bottom: 4px;
    }
    .cc-total.bank { color: #F87171; }
    .cc-total.bbx { color: #22D3EE; }

    .cc-sub {
      font-size: 9px; font-weight: 500;
      color: rgba(255,255,255,0.25);
      line-height: 1.4;
    }

    .cc-breakdown {
      margin-top: 8px;
      display: flex; flex-direction: column; gap: 3px;
    }
    .cc-line {
      display: flex; justify-content: space-between;
      font-size: 9px;
    }
    .cc-line-label { color: rgba(255,255,255,0.2); }
    .cc-line-val { color: rgba(255,255,255,0.4); font-weight: 600; }

    /* Savings highlight */
    .savings-card {
      width: 100%;
      background: linear-gradient(135deg, rgba(16,185,129,0.1) 0%, rgba(34,211,238,0.06) 100%);
      border: 1px solid rgba(16,185,129,0.2);
      border-radius: 16px;
      padding: 18px 16px;
      text-align: center;
      margin-bottom: 10px;
    }

    .sv-label {
      font-size: 9px; font-weight: 700;
      color: #10B981;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      margin-bottom: 4px;
    }
    .sv-amount {
      font-size: 32px; font-weight: 900;
      color: #10B981;
      line-height: 1;
      margin-bottom: 2px;
    }
    .sv-sub {
      font-size: 11px; color: rgba(255,255,255,0.35);
    }
    .sv-pct {
      display: inline-block;
      margin-top: 6px;
      font-size: 11px; font-weight: 700;
      color: #0A0D14;
      background: #10B981;
      padding: 3px 10px;
      border-radius: 100px;
    }

    /* Net yield comparison */
    .yield-row {
      display: flex; gap: 8px;
      margin-bottom: 12px;
    }
    .yield-card {
      flex: 1;
      background: rgba(255,255,255,0.02);
      border: 1px solid rgba(255,255,255,0.05);
      border-radius: 12px;
      padding: 10px 8px;
      text-align: center;
    }
    .yc-label {
      font-size: 8px; font-weight: 700;
      color: rgba(255,255,255,0.2);
      text-transform: uppercase;
      letter-spacing: 0.3px;
      margin-bottom: 2px;
    }
    .yc-value {
      font-size: 16px; font-weight: 800;
    }
    .yc-value.bank { color: #F87171; }
    .yc-value.bbx { color: #22D3EE; }
    .yc-value.diff { color: #10B981; }

    /* Min investment note */
    .min-note {
      width: 100%;
      background: rgba(245,158,11,0.06);
      border: 1px solid rgba(245,158,11,0.12);
      border-radius: 10px;
      padding: 8px 12px;
      display: flex; align-items: center; gap: 6px;
      margin-bottom: 12px;
    }
    .min-note.hidden { display: none; }
    .mn-icon { font-size: 14px; }
    .mn-text {
      font-size: 10px; font-weight: 500;
      color: #F59E0B;
      line-height: 1.3;
    }

    /* =============================================
       CTA + FOOTER
       ============================================= */
    .cta-section {
      width: 100%;
      opacity: 0;
      animation: fadeUp 0.4s ease 0.5s forwards;
    }

    .btn-primary {
      width: 100%;
      padding: 14px;
      border-radius: 14px; border: none;
      background: #22D3EE; color: #0A0D14;
      font-family: inherit;
      font-size: 14px; font-weight: 700;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
      box-shadow: 0 4px 15px rgba(34,211,238,0.25);
      transition: all 0.2s ease;
    }
    .btn-primary:active { transform: scale(0.98); }

    .footer-note {
      font-size: 9px; font-weight: 400;
      color: rgba(255,255,255,0.15);
      text-align: center;
      margin-top: 10px;
      line-height: 1.4;
    }

    /* =============================================
       TEST PANEL
       ============================================= */
    .test-panel {
      display: none;
      position: fixed; bottom: 10px; left: 10px; right: 10px;
      background: rgba(0,0,0,0.88);
      border-radius: 12px;
      padding: 8px 14px;
      z-index: 9999;
      font-size: 11px; color: #FFF;
      text-align: center;
      backdrop-filter: blur(10px);
    }
    .test-panel.show { display: block; }
    .tp-row { display: flex; gap: 6px; justify-content: center; }
    .tp-btn-sm {
      padding: 5px 8px;
      background: rgba(255,255,255,0.08); border: none;
      color: #94A3B8; font-size: 9px;
      font-weight: 600; border-radius: 6px;
      cursor: pointer; font-family: inherit;
    }
    .tp-btn-sm:active { background: rgba(255,255,255,0.15); color: #FFF; }

    .hidden { display: none !important; }
  </style>
</head>

<body>
  <!-- Test Panel -->
  <div class="test-panel" id="testPanel">
    <div style="font-size:9px;color:#64748B;margin-bottom:4px">PRESETS</div>
    <div class="tp-row">
      <button class="tp-btn-sm" onclick="setPreset(5000,2,4.5)">Starter $5K</button>
      <button class="tp-btn-sm" onclick="setPreset(50000,6,5.5)">Mid $50K</button>
      <button class="tp-btn-sm" onclick="setPreset(200000,12,6.0)">HNW $200K</button>
      <button class="tp-btn-sm" onclick="setPreset(500000,24,7.5)">Max $500K</button>
      <button class="tp-btn-sm" onclick="setPreset(150000,4,5.0)">Below Bank Min</button>
    </div>
  </div>

  <div class="modal" id="modal">
    <button class="dismiss-btn" id="dismissBtn" onclick="dismiss()">âœ•</button>

    <div class="content">
      <!-- Header -->
      <div class="header">
        <div class="brand-tag">BondbloX Â· Bond Calculator</div>
        <div class="header-title">How much are you<br>overpaying for bonds?</div>
        <div class="header-sub">Drag the sliders to see your potential savings<br>vs. a typical private bank.</div>
      </div>

      <!-- Sliders -->
      <div class="sliders-section">
        <div class="slider-card">
          <div class="sl-header">
            <span class="sl-label">Bond Investment Amount</span>
            <span class="sl-value" id="valAmount">$50,000</span>
          </div>
          <input type="range" id="sliderAmount" min="1000" max="500000" step="1000" value="50000" oninput="recalc()" />
          <div class="sl-range-labels">
            <span class="sl-min">$1,000</span>
            <span class="sl-max">$500,000</span>
          </div>
        </div>

        <div class="slider-card">
          <div class="sl-header">
            <span class="sl-label">Trades per Year</span>
            <span class="sl-value" id="valTrades">6</span>
          </div>
          <input type="range" id="sliderTrades" min="1" max="24" step="1" value="6" oninput="recalc()" />
          <div class="sl-range-labels">
            <span class="sl-min">1</span>
            <span class="sl-max">24</span>
          </div>
        </div>

        <div class="slider-card">
          <div class="sl-header">
            <span class="sl-label">Average Bond Yield</span>
            <span class="sl-value" id="valYield">5.50%</span>
          </div>
          <input type="range" id="sliderYield" min="2" max="10" step="0.25" value="5.5" oninput="recalc()" />
          <div class="sl-range-labels">
            <span class="sl-min">2.0%</span>
            <span class="sl-max">10.0%</span>
          </div>
        </div>
      </div>

      <!-- Results -->
      <div class="results-section">
        <!-- Min investment warning -->
        <div class="min-note hidden" id="minNote">
          <span class="mn-icon">ðŸ’¡</span>
          <span class="mn-text">Private banks typically require a <strong>$200,000 minimum</strong> for bond investments. With BondbloX, you can start from just <strong>$1,000</strong>.</span>
        </div>

        <!-- Fee comparison -->
        <div class="compare-row">
          <div class="compare-card bank">
            <div class="cc-label bank">Private Bank</div>
            <div class="cc-total bank" id="bankTotal">$0</div>
            <div class="cc-sub">annual fees</div>
            <div class="cc-breakdown">
              <div class="cc-line">
                <span class="cc-line-label">Trading (~1%)</span>
                <span class="cc-line-val" id="bankTrade">$0</span>
              </div>
              <div class="cc-line">
                <span class="cc-line-label">Custody (0.25%)</span>
                <span class="cc-line-val" id="bankCustody">$0</span>
              </div>
            </div>
          </div>

          <div class="compare-card bbx">
            <div class="cc-label bbx">BondbloX</div>
            <div class="cc-total bbx" id="bbxTotal">$0</div>
            <div class="cc-sub">annual fees</div>
            <div class="cc-breakdown">
              <div class="cc-line">
                <span class="cc-line-label">Trading (0.2%)</span>
                <span class="cc-line-val" id="bbxTrade">$0</span>
              </div>
              <div class="cc-line">
                <span class="cc-line-label">AUM (0.2%)</span>
                <span class="cc-line-val" id="bbxCustody">$0</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Savings highlight -->
        <div class="savings-card">
          <div class="sv-label">Your Annual Savings</div>
          <div class="sv-amount" id="svAmount">$0</div>
          <div class="sv-sub" id="svSub">saved per year with BondbloX</div>
          <div class="sv-pct" id="svPct">0% less</div>
        </div>

        <!-- Net yield -->
        <div class="yield-row">
          <div class="yield-card">
            <div class="yc-label">Net Yield (Bank)</div>
            <div class="yc-value bank" id="yieldBank">0.00%</div>
          </div>
          <div class="yield-card">
            <div class="yc-label">Net Yield (BondbloX)</div>
            <div class="yc-value bbx" id="yieldBbx">0.00%</div>
          </div>
          <div class="yield-card">
            <div class="yc-label">Extra Yield</div>
            <div class="yc-value diff" id="yieldDiff">+0.00%</div>
          </div>
        </div>
      </div>

      <!-- CTA -->
      <div class="cta-section">
        <button class="btn-primary" onclick="ctaClick()" id="ctaBtn">Start Investing on BondbloX</button>
        <div class="footer-note">
          BondbloX is regulated by the Monetary Authority of Singapore (MAS).<br>
          Fees shown are estimates for comparison. Actual costs may vary.<br>
          0.2% per trade Â· 0.2% annualised AUM fee Â· From $1,000
        </div>
      </div>
    </div>
  </div>

  <script>
    // =============================================
    // STATE
    // =============================================
    const fees = CONFIG.fees;
    let interactionCount = 0;
    let hasLoggedComplete = false;

    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('test') === 'true') {
      document.getElementById('testPanel').classList.add('show');
    }
    if (!CONFIG.includeDismissButton) {
      document.getElementById('dismissBtn').classList.add('hidden');
    }

    // =============================================
    // RECALCULATE
    // =============================================
    window.recalc = function () {
      const amount = parseFloat(document.getElementById('sliderAmount').value);
      const trades = parseInt(document.getElementById('sliderTrades').value);
      const yieldPct = parseFloat(document.getElementById('sliderYield').value);

      // Update slider value displays
      document.getElementById('valAmount').textContent = formatCurrency(amount);
      document.getElementById('valTrades').textContent = trades;
      document.getElementById('valYield').textContent = yieldPct.toFixed(2) + '%';

      // Update slider track fill via CSS
      updateSliderTrack('sliderAmount');
      updateSliderTrack('sliderTrades');
      updateSliderTrack('sliderYield');

      // Calculate fees
      // Bank: ~1% markup per trade + 0.25% custody
      const avgTradeSize = amount / trades; // approximate
      const bankTradeCost = amount * fees.bank.tradeFee * trades / trades; // simplified: 1% of total traded
      // More accurately: each trade is (amount/trades) at 1% markup
      const bankTradeFees = trades * (amount / trades) * fees.bank.tradeFee;
      // Simplify: in bond world, the 1% is on the notional per trade roundtrip
      // Let's model: bank charges ~1% spread per trade on the trade notional
      const tradeNotional = amount; // assume portfolio turnover = amount Ã— (trades/2) for buys
      const bankTrading = amount * fees.bank.tradeFee; // 1% annual spread cost on portfolio
      const bankCustody = amount * fees.bank.custodyFee;
      const bankTotal = bankTrading + bankCustody;

      // BondbloX: 0.2% per trade + 0.2% AUM
      const bbxTrading = amount * fees.bondblox.tradeFee; // 0.2% annual
      const bbxCustody = amount * fees.bondblox.custodyFee;
      const bbxTotal = bbxTrading + bbxCustody;

      const savings = bankTotal - bbxTotal;
      const savingsPct = bankTotal > 0 ? ((savings / bankTotal) * 100) : 0;

      // Net yields
      const grossYield = yieldPct;
      const bankNetYield = grossYield - ((bankTotal / amount) * 100);
      const bbxNetYield = grossYield - ((bbxTotal / amount) * 100);
      const yieldDiff = bbxNetYield - bankNetYield;

      // Update DOM
      document.getElementById('bankTrade').textContent = formatCurrency(bankTrading);
      document.getElementById('bankCustody').textContent = formatCurrency(bankCustody);
      document.getElementById('bankTotal').textContent = formatCurrency(bankTotal);

      document.getElementById('bbxTrade').textContent = formatCurrency(bbxTrading);
      document.getElementById('bbxCustody').textContent = formatCurrency(bbxCustody);
      document.getElementById('bbxTotal').textContent = formatCurrency(bbxTotal);

      document.getElementById('svAmount').textContent = formatCurrency(savings);
      document.getElementById('svPct').textContent = Math.round(savingsPct) + '% less in fees';

      document.getElementById('yieldBank').textContent = bankNetYield.toFixed(2) + '%';
      document.getElementById('yieldBbx').textContent = bbxNetYield.toFixed(2) + '%';
      document.getElementById('yieldDiff').textContent = '+' + yieldDiff.toFixed(2) + '%';

      // Min investment warning
      const minNote = document.getElementById('minNote');
      if (amount < fees.bank.minInvestment) {
        minNote.classList.remove('hidden');
      } else {
        minNote.classList.add('hidden');
      }

      // Track interaction
      interactionCount++;
      if (interactionCount <= 3) {
        pushEvent(CONFIG.events.calcInteracted, {
          Amount: amount,
          Trades: trades,
          Yield: yieldPct,
          Savings: Math.round(savings),
          Interaction: interactionCount,
        });
      }

      // Log completed on 3+ interactions
      if (interactionCount === 3 && !hasLoggedComplete) {
        hasLoggedComplete = true;
        pushEvent(CONFIG.events.calcCompleted, {
          Amount: amount,
          Trades: trades,
          Yield: yieldPct,
          Bank_Fees: Math.round(bankTotal),
          BBX_Fees: Math.round(bbxTotal),
          Annual_Savings: Math.round(savings),
          Savings_Pct: Math.round(savingsPct),
          Net_Yield_Bank: bankNetYield.toFixed(2),
          Net_Yield_BBX: bbxNetYield.toFixed(2),
        });
      }
    };

    // =============================================
    // SLIDER TRACK FILL
    // =============================================
    function updateSliderTrack(id) {
      const slider = document.getElementById(id);
      const min = parseFloat(slider.min);
      const max = parseFloat(slider.max);
      const val = parseFloat(slider.value);
      const pct = ((val - min) / (max - min)) * 100;
      slider.style.background = `linear-gradient(90deg, #22D3EE 0%, #22D3EE ${pct}%, rgba(255,255,255,0.06) ${pct}%, rgba(255,255,255,0.06) 100%)`;
    }

    // =============================================
    // FORMAT
    // =============================================
    function formatCurrency(n) {
      if (n >= 1000) {
        return '$' + n.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
      }
      return '$' + n.toFixed(0);
    }

    // =============================================
    // PRESETS (test mode)
    // =============================================
    window.setPreset = function (a, t, y) {
      document.getElementById('sliderAmount').value = a;
      document.getElementById('sliderTrades').value = t;
      document.getElementById('sliderYield').value = y;
      recalc();
    };

    // =============================================
    // ACTIONS
    // =============================================
    window.ctaClick = function () {
      const amount = parseFloat(document.getElementById('sliderAmount').value);
      const savings = parseFloat(document.getElementById('svAmount').textContent.replace(/[^0-9.]/g, ''));

      pushEvent(CONFIG.events.calcCta, {
        Amount: amount,
        Savings_Shown: savings,
      });
      if (CONFIG.cta.url) window.location.href = CONFIG.cta.url;
    };

    window.dismiss = function () {
      pushEvent(CONFIG.events.calcDismissed, {
        Interactions: interactionCount,
        Completed: hasLoggedComplete,
      });
      try {
        if (typeof CleverTap !== 'undefined' && CleverTap.dismissInAppNotification) {
          CleverTap.dismissInAppNotification(); return;
        }
      } catch (e) {}
      window.location.href = 'wzrk://exit';
    };

    // =============================================
    // CLEVERTAP
    // =============================================
    function pushEvent(name, props) {
      const payload = props || {};
      payload.Timestamp = new Date().toISOString();
      try {
        if (typeof CleverTap !== 'undefined' && CleverTap.pushEvent)
          CleverTap.pushEvent(name, JSON.stringify(payload));
        if (typeof clevertap !== 'undefined' && clevertap.event)
          clevertap.event.push(name, payload);
        if (window.webkit?.messageHandlers?.clevertap)
          window.webkit.messageHandlers.clevertap.postMessage(JSON.stringify({ type: 'event', name, props: payload }));
      } catch (e) { console.log('[CT]', name, payload); }
    }

    // =============================================
    // INIT
    // =============================================
    recalc();

    pushEvent(CONFIG.events.calcViewed, {
      Default_Amount: CONFIG.sliders.investAmount.default,
    });
  </script>
</body>
</html>
