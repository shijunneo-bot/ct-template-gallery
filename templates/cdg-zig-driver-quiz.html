<!DOCTYPE html>
<html lang="en">

<head>
  <!-- -------------------- Configurable Settings -------------------- -->
  <script>
    const CONFIG = {
      // ‚ùå Whether to show the X button to close/dismiss the quiz
      includeDismissButton: true,

      // üåà Background color/gradient of the quiz modal (Zig blue)
      background: "linear-gradient(170deg, #0142AF 0%, #033A94 40%, #022B6E 100%)",

      // üéâ Whether to enable the confetti effect on result reveal
      enableConfettiOnReveal: true,

      // üó£Ô∏è Cover screen headline
      coverTitle: {
        text: "What Kind of SG <br>Driver Are You? üá∏üá¨",
        fontSize: "27px",
        color: "#FFFFFF",
      },

      // üí¨ Cover screen subtitle
      coverSubtitle: {
        text: "8 brutally honest questions. 1 personality you already knew deep down. Don't say we never warn you ah.",
        fontSize: "13px",
        color: "#93B4E8",
      },

      // ‚ñ∂Ô∏è Start button settings
      startButton: {
        text: "Huat ah! Let's Go üöï",
        background: "linear-gradient(135deg, #FFD600 0%, #FFC107 100%)",
        color: "#022B6E",
      },

      // üé® Accent color (CDG taxi yellow)
      accentColor: "#FFD600",

      // üé® Question screen background
      questionBackground: "linear-gradient(170deg, #F8FAFF 0%, #EEF2FF 50%, #E0E7FF 100%)",

      // üìã Question choice button styling
      choiceStyle: {
        background: "#ffffff",
        border: "2px solid #E0E7FF",
        hoverBorder: "#0142AF",
        hoverBackground: "#F0F4FF",
        selectedBorder: "#0142AF",
        selectedBackground: "#E8EEFF",
        color: "#1E293B",
        fontSize: "13.5px",
      },

      // üõçÔ∏è CTA button on the result screen
      claimButton: {
        enabled: true,
        text: "üéÅ  Claim ZigRewards",
        background: "linear-gradient(135deg, #FFD600 0%, #FFC107 100%)",
        color: "#022B6E",
        url: "https://www.zig.live/",
      },

      // üìã Copy instruction text settings
      copyInstruction: {
        color: "#94A3B8",
        copiedColor: "#0142AF",
      },

      // üìä CleverTap event settings
      events: {
        quizStarted: "SG_Driver_Quiz_Started",
        questionAnswered: "SG_Driver_Quiz_Question_Answered",
        quizCompleted: "SG_Driver_Quiz_Completed",
        resultClaimed: "SG_Driver_Quiz_Result_Claimed",
        quizDismissed: "SG_Driver_Quiz_Dismissed",
      },

      // ‚ùì Quiz questions ‚Äî Enneagram-influenced (motivation + stress-based)
      // Each choice has a primary trait (+2) and wing trait (+1)
      questions: [
        {
          // ENNEAGRAM: Core motivation ‚Äî what drives you on the road?
          text: "Deep down, why do you REALLY drive the way you do?",
          emoji: "üß†",
          choices: [
            { text: "üí∞  Cannot lose. Every cent on ERP, petrol, parking ‚Äî I calculate", traits: { kiasu: 3 } },
            { text: "√¢≈°¬°  I just need to GET THERE. Efficiency is respect", traits: { warrior: 3 } },
            { text: "üòå  No stress lah. The road is my therapy session", traits: { steady: 3 } },
            { text: "‚ú®  My car is an extension of me. Must maintain standards", traits: { atas: 3 } },
          ],
        },
        {
          // ENNEAGRAM: Behaviour under stress
          text: "You're stuck in a CTE jam at 6pm. Peak ERP somemore. What happens?",
          emoji: "üò§",
          choices: [
            { text: "üì±  Already calculating if I should U-turn and take Lornie Road instead", traits: { kiasu: 2, warrior: 1 } },
            { text: "üìØ  Horn. Signal. Cut lane. Repeat. I have a dinner to make", traits: { warrior: 2, kiasu: 1 } },
            { text: "üéµ  Turn up YES 933, crack open the Pokka. This is fine", traits: { steady: 2, atas: 1 } },
            { text: "üò©  Texting 5 people that I'll be late, updating IG story about the jam", traits: { atas: 2, steady: 1 } },
          ],
        },
        {
          // ENNEAGRAM: Interpersonal ‚Äî how you relate to other drivers
          text: "Someone cuts into your lane without signalling. Your move?",
          emoji: "üöó",
          choices: [
            { text: "üèéÔ∏è  Speed up to close the gap. You think my lane free one ah?", traits: { kiasu: 2, warrior: 1 } },
            { text: "üìØ  PAAARP. Long horn + headlight flash. Must educate them", traits: { warrior: 2, kiasu: 1 } },
            { text: "ü§∑  Nah, let them go lah. My life more important than my lane", traits: { steady: 2, atas: 1 } },
            { text: "üò§  Silent fury + dashcam running. Will review footage later", traits: { atas: 2, warrior: 1 } },
          ],
        },
        {
          // ENNEAGRAM: Growth direction ‚Äî ideal self on the road
          text: "On your BEST driving day, what are you most proud of?",
          emoji: "üåü",
          choices: [
            { text: "üßÆ  Avoided $8 of ERP, found free parking, fuel light still not on", traits: { kiasu: 2, steady: 1 } },
            { text: "‚è±Ô∏è  Made it from Jurong to Changi in 28 minutes. Personal best", traits: { warrior: 2, kiasu: 1 } },
            { text: "‚òï  Entire drive was peaceful. No horn, no stress, just vibes", traits: { steady: 2, atas: 1 } },
            { text: "üì∏  Car is spotless, playlist is perfect, outfit matches the interior", traits: { atas: 2, steady: 1 } },
          ],
        },
        {
          // ENNEAGRAM: Core fear ‚Äî what you avoid
          text: "What's your WORST nightmare on Singapore roads?",
          emoji: "üò±",
          choices: [
            { text: "üí∏  Kena ERP at 7:59pm because you were 1 SECOND too slow", traits: { kiasu: 2, warrior: 1 } },
            { text: "üêå  Stuck behind an uncle doing 60 on the fast lane. MOVE LAH", traits: { warrior: 2, kiasu: 1 } },
            { text: "ü§¨  Road rage. Someone come down from car and knock your window", traits: { steady: 2, kiasu: 1 } },
            { text: "ü™®  A stone chip on the bumper. Or worse ‚Äî someone scratches your door", traits: { atas: 2, warrior: 1 } },
          ],
        },
        {
          // ENNEAGRAM: Daily habits ‚Äî routine reveals type
          text: "You just parked at a shopping mall. First thing you do?",
          emoji: "üÖøÔ∏è",
          choices: [
            { text: "üì∏  Take photo of the lot number. And check if got free parking after 6", traits: { kiasu: 2, atas: 1 } },
            { text: "üèÉ  Lock and go. I parked in 12 seconds flat, no time to waste", traits: { warrior: 2, steady: 1 } },
            { text: "üö∂  Take my time, stroll to the lift. Maybe scroll phone first", traits: { steady: 2, kiasu: 1 } },
            { text: "ü™û  Quick mirror check, make sure car is centred perfectly in the lot", traits: { atas: 2, kiasu: 1 } },
          ],
        },
        {
          // ENNEAGRAM: Social dynamics ‚Äî passenger relationships
          text: "Your friend says your driving got one pattern. What's the pattern?",
          emoji: "üë•",
          choices: [
            { text: "üó∫Ô∏è  \"You always find the cheapest route even if it takes longer\"", traits: { kiasu: 2, steady: 1 } },
            { text: "üò¨  \"Bro, the speed limit is 90, not a suggestion to go 110\"", traits: { warrior: 2, atas: 1 } },
            { text: "üò¥  \"Can you drive a bit faster? We late already\"", traits: { steady: 2, kiasu: 1 } },
            { text: "üö´  \"Why you don't let people eat in your car?\"", traits: { atas: 2, warrior: 1 } },
          ],
        },
        {
          // ENNEAGRAM: Values/identity ‚Äî what the car means to you
          text: "If your car could talk, what would it say about you?",
          emoji: "üöï",
          choices: [
            { text: "üßæ  \"This fella knows every petrol station with 5 cents discount\"", traits: { kiasu: 2, steady: 1 } },
            { text: "üèÅ  \"We don't cruise. We ARRIVE. Usually ahead of schedule\"", traits: { warrior: 2, atas: 1 } },
            { text: "üõãÔ∏è  \"He treats me like a living room. Recline seat, relax, no rush\"", traits: { steady: 2, warrior: 1 } },
            { text: "üßº  \"Washed every Saturday, leather conditioned monthly, no shoes rule\"", traits: { atas: 2, kiasu: 1 } },
          ],
        },
      ],

      // üéÅ Quiz results ‚Äî 4 SG driver archetypes (from Motorist.sg, reframed)
      results: {
        kiasu: {
          title: "The Kiasu King üëë",
          emoji: "üëë",
          vibe: "Scared to lose? No ‚Äî scared to NOT WIN",
          color: "#D97706",
          bgGradient: "linear-gradient(170deg, #FFFBEB 0%, #FEF3C7 40%, #FDE68A 100%)",
          description: "You know every ERP gantry timing by heart. Free parking after 10pm? You'll wait in the car. Cheaper petrol in JB? Road trip la! You're not cheap ‚Äî you're strategically optimised. Singapore would be proud.",
          promoCode: "KIASU10",
          promoText: "Save $3 off your next Zig ride ‚Äî because you love savings üëë",
          promoSubtext: "Min. $12 fare ¬∑ Valid until 30 Jun 2026",
        },
        warrior: {
          title: "The Road Warrior √¢≈°¬°",
          emoji: "√¢≈°¬°",
          vibe: "The horn is my love language",
          color: "#DC2626",
          bgGradient: "linear-gradient(170deg, #FEF2F2 0%, #FEE2E2 40%, #FECACA 100%)",
          description: "You signal, honk, flash, and arrive. Lane 1 is your kingdom. Every amber light is a personal challenge. People say you're aggressive ‚Äî you prefer 'decisive'. You've never been late in your life and you're not starting now.",
          promoCode: "WARRIOR15",
          promoText: "15% off your next Zig ride ‚Äî because time is money ‚ö°",
          promoSubtext: "Max $5 discount ¬∑ Valid until 30 Jun 2026",
        },
        steady: {
          title: "Steady Pom Pi Pi üòé",
          emoji: "üòé",
          vibe: "No signal? No problem. No ERP? Even better",
          color: "#16A34A",
          bgGradient: "linear-gradient(170deg, #F0FDF4 0%, #DCFCE7 40%, #BBF7D0 100%)",
          description: "Lane 2, cruise control, YES 933 on the radio. You drive like life is a Sunday and every road is East Coast Park. Tailgaters? Can't hear them over your podcast. Your blood pressure is the envy of Singapore.",
          promoCode: "STEADY5",
          promoText: "Chill! Here's $5 off your next Zig ride üòé",
          promoSubtext: "Min. $10 fare ¬∑ Valid until 30 Jun 2026",
        },
        atas: {
          title: "The Atas Driver üíé",
          emoji: "üíé",
          vibe: "Car is my second home. Actually, my FIRST home",
          color: "#7C3AED",
          bgGradient: "linear-gradient(170deg, #FAF5FF 0%, #F3E8FF 40%, #E9D5FF 100%)",
          description: "No food, no shoes on dashboard, no funny smell allowed. You wash your car more than you wash your hair. Every scratch is emotional damage. Your car freshener costs more than some people's lunch. And you wouldn't have it any other way.",
          promoCode: "ATAS20",
          promoText: "Treat yourself! 20% off your next Zig Premium ride üíé",
          promoSubtext: "Max $8 discount ¬∑ Valid until 30 Jun 2026",
        },
      },
    };
  </script>
  <!-- -------------------- End of Configurable Settings -------------------- -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CDG Zig ‚Äì What Kind of SG Driver Are You?</title>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@600;700;800;900&display=swap');

    :root {
      --accent: #FFD600;
      --zig-blue: #0142AF;
      --zig-dark: #022B6E;
      --shimmer-hue-1: 45deg;
      --shimmer-hue-2: 210deg;
    }

    @property --mask {
      syntax: "<angle>";
      inherits: false;
      initial-value: 33deg;
    }

    @keyframes shimmerSpin {
      0% { --mask: 0deg; }
      100% { --mask: 360deg; }
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    html, body {
      height: 100%;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Nunito', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #0a1628;
    }

    /* ========== MODAL ========== */
    .modal {
      display: flex;
      flex-direction: column;
      align-items: center;
      height: 100%;
      max-height: 600px;
      max-width: 340px;
      padding: 24px 20px;
      justify-content: center;
      width: 100%;
      text-align: center;
      border-radius: 32px;
      position: relative;
      overflow: hidden;
      transition: background 0.5s ease;
      box-shadow: 0 8px 40px rgba(0,0,0,0.25), 0 0 0 1px rgba(255,214,0,0.08);
    }

    /* Road lane dashes decoration */
    .lane-deco {
      position: absolute;
      width: 4px;
      background: rgba(255,214,0,0.12);
      border-radius: 2px;
      pointer-events: none;
      z-index: 0;
      animation: dashScroll 3s linear infinite;
    }
    .lane-deco.left { left: 16px; }
    .lane-deco.right { right: 16px; }
    .lane-deco:nth-child(1) { height: 24px; top: 20%; animation-delay: 0s; }
    .lane-deco:nth-child(2) { height: 24px; top: 45%; animation-delay: -1s; }
    .lane-deco:nth-child(3) { height: 24px; top: 70%; animation-delay: -2s; }
    .lane-deco:nth-child(4) { height: 24px; top: 20%; animation-delay: -0.5s; }
    .lane-deco:nth-child(5) { height: 24px; top: 45%; animation-delay: -1.5s; }
    .lane-deco:nth-child(6) { height: 24px; top: 70%; animation-delay: -2.5s; }
    @keyframes dashScroll {
      0% { opacity: 0.15; transform: translateY(-20px); }
      50% { opacity: 0.3; }
      100% { opacity: 0.15; transform: translateY(20px); }
    }

    /* ========== CLOSE BUTTON ========== */
    .close-btn {
      position: absolute;
      top: 14px;
      right: 14px;
      appearance: none;
      border: 0;
      background: rgba(255,255,255,0.1);
      color: rgba(255,255,255,0.5);
      font-size: 15px;
      line-height: 1;
      cursor: pointer;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
      z-index: 20;
      font-family: inherit;
      font-weight: 700;
    }
    .close-btn:hover { background: rgba(255,255,255,0.18); }

    /* ========== ZIG LOGO ========== */
    .zig-logo {
      width: 48px;
      height: 48px;
      border-radius: 12px;
      object-fit: contain;
      margin-bottom: 6px;
      opacity: 0.9;
    }

    /* ========== SCREENS ========== */
    .screen {
      display: none;
      width: 100%;
      flex-direction: column;
      align-items: center;
      position: relative;
      z-index: 1;
    }
    .screen.active { display: flex; }

    /* ========== COVER SCREEN ========== */
    .cover-hero {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, rgba(255,214,0,0.15), transparent 60%), rgba(255,255,255,0.06);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 60px;
      margin-bottom: 12px;
      box-shadow: 0 4px 30px rgba(255,214,0,0.12), inset 0 0 30px rgba(255,255,255,0.03);
      animation: float 3s ease-in-out infinite;
      position: relative;
      border: 2px solid rgba(255,214,0,0.15);
    }
    .cover-hero::before {
      content: 'üí®';
      position: absolute;
      font-size: 22px;
      bottom: 6px;
      right: -2px;
      animation: puff 2s ease-in-out infinite 0.5s;
    }
    .cover-hero::after {
      content: 'üá∏üá¨';
      position: absolute;
      font-size: 16px;
      top: 2px;
      left: 4px;
      animation: sparkle 2.5s ease-in-out infinite;
    }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-6px); }
    }
    @keyframes puff {
      0%, 100% { opacity: 0.3; transform: translateX(0) scale(1); }
      50% { opacity: 0.7; transform: translateX(5px) scale(1.1); }
    }
    @keyframes sparkle {
      0%, 100% { opacity: 0.4; transform: scale(0.9); }
      50% { opacity: 1; transform: scale(1.1); }
    }

    .cover-badge {
      display: inline-block;
      background: rgba(255,214,0,0.15);
      color: #FFD600;
      font-size: 10px;
      font-weight: 800;
      letter-spacing: 1.5px;
      text-transform: uppercase;
      padding: 5px 14px;
      border-radius: 20px;
      margin-bottom: 8px;
      border: 1px solid rgba(255,214,0,0.1);
    }

    .cover-title {
      font-weight: 900;
      line-height: 1.15;
      letter-spacing: -0.5px;
    }
    .cover-subtitle {
      line-height: 1.55;
      margin-top: 10px;
      padding: 0 4px;
    }
    .btn-start {
      margin-top: 20px;
      padding: 15px 40px;
      border: none;
      border-radius: 50px;
      font-size: 16px;
      font-weight: 800;
      cursor: pointer;
      font-family: inherit;
      transition: transform 0.15s, box-shadow 0.2s;
      box-shadow: 0 4px 20px rgba(255,214,0,0.3);
    }
    .btn-start:hover { box-shadow: 0 6px 28px rgba(255,214,0,0.4); transform: translateY(-1px); }
    .btn-start:active { transform: scale(0.97); }

    .cover-meta {
      margin-top: 14px;
      font-size: 11.5px;
      color: rgba(255,255,255,0.3);
      font-weight: 700;
    }
    .cover-meta span { color: var(--accent); }

    /* ========== QUESTION SCREEN ========== */
    .q-header {
      width: 100%;
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 4px;
    }
    .progress-track {
      flex: 1;
      height: 8px;
      background: rgba(0,0,0,0.06);
      border-radius: 4px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      border-radius: 4px;
      transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .q-step {
      font-size: 13px;
      font-weight: 800;
      color: rgba(0,0,0,0.25);
      white-space: nowrap;
    }

    .q-emoji {
      font-size: 44px;
      margin: 8px 0 6px;
      line-height: 1;
      animation: popIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    }
    @keyframes popIn {
      0% { transform: scale(0.5) rotate(-10deg); opacity: 0; }
      100% { transform: scale(1) rotate(0deg); opacity: 1; }
    }

    .q-text {
      font-size: 16px;
      font-weight: 700;
      line-height: 1.4;
      color: #1E293B;
      margin-bottom: 12px;
      padding: 0 2px;
      min-height: 44px;
    }
    .choices {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 7px;
    }
    .choice-btn {
      width: 100%;
      padding: 11px 13px;
      border-radius: 14px;
      font-weight: 600;
      text-align: left;
      cursor: pointer;
      transition: all 0.2s;
      line-height: 1.4;
      font-family: inherit;
      -webkit-tap-highlight-color: transparent;
      box-shadow: 0 1px 3px rgba(0,0,0,0.04);
    }
    .choice-btn:active { transform: scale(0.98); }
    .choice-btn.selected { font-weight: 700; box-shadow: 0 2px 12px rgba(1,66,175,0.15); }

    /* ========== LOADING SCREEN ========== */
    .loading-road {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 42px;
      margin-bottom: 16px;
      position: relative;
    }
    .loading-taxi {
      animation: taxiDrive 1.6s ease-in-out infinite;
    }
    @keyframes taxiDrive {
      0%, 100% { transform: translateX(0) rotate(0); }
      25% { transform: translateX(10px) rotate(1deg); }
      50% { transform: translateX(0) rotate(0); }
      75% { transform: translateX(-10px) rotate(-1deg); }
    }
    .loading-trail {
      display: flex;
      gap: 6px;
    }
    .loading-trail span {
      font-size: 18px;
      opacity: 0.3;
      animation: trailPuff 1.2s ease-in-out infinite;
    }
    .loading-trail span:nth-child(2) { animation-delay: 0.2s; }
    .loading-trail span:nth-child(3) { animation-delay: 0.4s; }
    @keyframes trailPuff {
      0%, 100% { opacity: 0.15; transform: scale(0.8) translateX(0); }
      50% { opacity: 0.5; transform: scale(1.1) translateX(-4px); }
    }

    .loading-dots {
      display: flex;
      gap: 6px;
      margin-top: 12px;
    }
    .loading-dots span {
      width: 9px;
      height: 9px;
      border-radius: 50%;
      background: var(--zig-blue);
      opacity: 0.3;
      animation: dotPulse 1.2s ease-in-out infinite;
    }
    .loading-dots span:nth-child(2) { animation-delay: 0.2s; }
    .loading-dots span:nth-child(3) { animation-delay: 0.4s; }
    @keyframes dotPulse {
      0%, 100% { opacity: 0.2; transform: scale(0.8); }
      50% { opacity: 1; transform: scale(1.15); }
    }
    .loading-text { font-size: 17px; font-weight: 800; color: #1E293B; }
    .loading-subtext { font-size: 13px; color: #94A3B8; margin-top: 4px; font-weight: 600; }

    /* ========== RESULT SCREEN ========== */
    .result-emoji {
      font-size: 60px;
      margin-bottom: 6px;
      line-height: 1;
      animation: resultPop 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    @keyframes resultPop {
      0% { transform: scale(0) rotate(-25deg); }
      60% { transform: scale(1.2) rotate(5deg); }
      100% { transform: scale(1) rotate(0deg); }
    }
    .result-badge {
      display: inline-block;
      padding: 4px 14px;
      border-radius: 20px;
      font-size: 10.5px;
      font-weight: 800;
      letter-spacing: 1.2px;
      text-transform: uppercase;
      margin-bottom: 4px;
    }
    .result-title {
      font-size: 24px;
      font-weight: 900;
      color: #1E293B;
      letter-spacing: -0.3px;
    }
    .result-vibe {
      font-size: 12.5px;
      font-weight: 700;
      margin-top: 2px;
      font-style: italic;
    }
    .result-desc {
      font-size: 12.5px;
      line-height: 1.55;
      color: #475569;
      margin-top: 8px;
      padding: 0 2px;
    }

    /* ========== PROMO CARD ========== */
    .promo-wrapper {
      width: 100%;
      position: relative;
      border-radius: 18px;
      overflow: visible;
      margin-top: 12px;
    }
    .promo-card {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 3px;
      padding: 14px 14px 10px;
      background: #ffffff;
      border-radius: 18px;
      width: 100%;
      box-sizing: border-box;
      cursor: pointer;
      transition: transform 0.12s;
      box-shadow: 0 2px 12px rgba(0,0,0,0.06);
      border: 2px dashed #E0E7FF;
      position: relative;
    }
    .promo-card:active { transform: scale(0.98); }

    /* Zig logo tab */
    .promo-card::before {
      content: '';
      position: absolute;
      width: 28px;
      height: 28px;
      top: -14px;
      right: 14px;
      background: url('https://www.zig.live/Zig_Logo.png') center/contain no-repeat;
      border-radius: 6px;
    }

    .promo-label { font-size: 12px; font-weight: 700; color: #64748B; }
    .promo-code-row { display: flex; align-items: center; gap: 6px; }
    .promo-code { font-size: 22px; font-weight: 900; letter-spacing: 2px; }
    .copy-btn {
      appearance: none;
      border: none;
      background: none;
      cursor: pointer;
      padding: 2px;
      display: flex;
      align-items: center;
      transition: transform 0.1s;
    }
    .copy-btn:active { transform: scale(0.85); }
    .copy-instruction { font-size: 11px; font-weight: 600; transition: color 0.2s; }
    .promo-subtext { font-size: 10.5px; color: #94A3B8; font-weight: 600; margin-top: 2px; }

    /* Shimmer */
    .shimmer {
      position: absolute;
      inset: -40px;
      border-radius: inherit;
      mix-blend-mode: plus-lighter;
      pointer-events: none;
      opacity: 0;
      visibility: hidden;
      mask-image: conic-gradient(from var(--mask, 0deg),
          transparent 0%, transparent 10%, black 36%, black 45%,
          transparent 50%, transparent 60%, black 85%, black 95%, transparent 100%);
      mask-size: cover;
      animation: shimmerSpin 3s linear infinite both -0.5s;
      z-index: 10;
      transition: opacity 0.3s ease;
    }
    .shimmer::before {
      content: "";
      border-radius: inherit;
      position: absolute;
      inset: 40px;
      opacity: 1;
      box-shadow: 0 0 3px 1px hsl(var(--shimmer-hue-1) 90% 65%),
        0 0 10px 6px hsl(var(--shimmer-hue-2) 80% 50%);
      z-index: -1;
    }
    .promo-wrapper.shimmer-active .shimmer {
      opacity: 1;
      visibility: visible;
      animation: shimmerSpin 2s linear infinite;
    }

    @keyframes pulsate {
      0% { transform: scale(1); }
      50% { transform: scale(1.03); }
      100% { transform: scale(1); }
    }
    .pulsate { animation: pulsate 1.5s ease-in-out 3; }

    /* Buttons */
    .btn-claim {
      margin-top: 12px;
      padding: 14px 34px;
      border: none;
      border-radius: 50px;
      font-size: 15px;
      font-weight: 800;
      cursor: pointer;
      font-family: inherit;
      transition: transform 0.15s, box-shadow 0.2s;
      box-shadow: 0 4px 16px rgba(255,214,0,0.25);
    }
    .btn-claim:hover { box-shadow: 0 6px 24px rgba(255,214,0,0.35); transform: translateY(-1px); }
    .btn-claim:active { transform: scale(0.97); }

    .btn-retake {
      margin-top: 6px;
      padding: 8px 20px;
      background: transparent;
      border: none;
      font-size: 13px;
      font-weight: 700;
      color: rgba(0,0,0,0.3);
      cursor: pointer;
      font-family: inherit;
      text-decoration: underline;
      text-underline-offset: 2px;
    }
    .btn-retake:hover { color: rgba(0,0,0,0.5); }

    /* Transitions */
    .fade-in { animation: fadeIn 0.35s ease forwards; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Screen-specific */
    .modal.on-q .close-btn,
    .modal.on-r .close-btn { color: rgba(0,0,0,0.3); background: rgba(0,0,0,0.05); }
    .modal.on-q .lane-deco,
    .modal.on-r .lane-deco { background: rgba(0,0,0,0.04); }
  </style>
</head>

<body>
  <div class="modal" id="modal">
    <!-- Road lane dashes -->
    <div class="lane-deco left" style="top:18%"></div>
    <div class="lane-deco left" style="top:46%"></div>
    <div class="lane-deco left" style="top:74%"></div>
    <div class="lane-deco right" style="top:25%"></div>
    <div class="lane-deco right" style="top:53%"></div>
    <div class="lane-deco right" style="top:81%"></div>

    <button class="close-btn" id="closeBtn" aria-label="Close">‚úï</button>

    <!-- ===== COVER ===== -->
    <div id="screen-cover" class="screen active">
      <img src="https://www.zig.live/Zig_Logo.png" alt="CDG Zig" class="zig-logo" />
      <div class="cover-hero">üöï</div>
      <span class="cover-badge">üá∏üá¨ SG Driver Personality Quiz</span>
      <h1 class="cover-title" id="coverTitle"></h1>
      <p class="cover-subtitle" id="coverSubtitle"></p>
      <button class="btn-start" id="btnStart"></button>
      <p class="cover-meta">‚è±Ô∏è <span>2 min</span> ¬∑ üéÅ ZigRewards promo at the end</p>
    </div>

    <!-- ===== QUESTION ===== -->
    <div id="screen-question" class="screen">
      <div class="q-header">
        <div class="progress-track">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        <span class="q-step" id="qStep"></span>
      </div>
      <div class="q-emoji" id="qEmoji"></div>
      <p class="q-text" id="qText"></p>
      <div class="choices" id="choicesContainer"></div>
    </div>

    <!-- ===== LOADING ===== -->
    <div id="screen-loading" class="screen">
      <div class="loading-road">
        <div class="loading-trail"><span>üí®</span><span>üí®</span><span>üí®</span></div>
        <div class="loading-taxi">üöï</div>
      </div>
      <p class="loading-text">Analysing your road DNA...</p>
      <p class="loading-subtext">Checking ERP history & horn frequency</p>
      <div class="loading-dots"><span></span><span></span><span></span></div>
    </div>

    <!-- ===== RESULT ===== -->
    <div id="screen-result" class="screen">
      <div class="result-emoji" id="rEmoji"></div>
      <span class="result-badge" id="rBadge"></span>
      <h2 class="result-title" id="rTitle"></h2>
      <p class="result-vibe" id="rVibe"></p>
      <p class="result-desc" id="rDesc"></p>

      <div class="promo-wrapper" id="promoWrapper">
        <span class="shimmer"></span>
        <div class="promo-card" id="promoCard">
          <span class="promo-label" id="promoLabel"></span>
          <div class="promo-code-row">
            <span class="promo-code" id="promoCode"></span>
            <button class="copy-btn" id="copyBtn" title="Copy code">
              <svg width="18" height="19" viewBox="0 0 20 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd"
                  d="M13 13.8444V17.8444C13 18.4444 12.6 18.8444 12 18.8444H3C2.4 18.8444 2 18.4444 2 17.8444V8.84442C2 8.24442 2.4 7.84442 3 7.84442H7V3.84442C7 3.24442 7.4 2.84442 8 2.84442H17C17.6 2.84442 18 3.24442 18 3.84442V12.8444C18 13.4444 17.6 13.8444 17 13.8444H13ZM12 13.8444H8C7.4 13.8444 7 13.4444 7 12.8444V8.84442H3V17.8444H12V13.8444ZM17 3.84442H8V12.8444H17V3.84442Z"
                  fill="#4A4C4C" />
              </svg>
            </button>
          </div>
          <div class="copy-instruction" id="copyInstruction">Tap to copy code</div>
          <div class="promo-subtext" id="promoSubtext"></div>
        </div>
      </div>

      <button class="btn-claim" id="btnClaim"></button>
      <button class="btn-retake" id="btnRetake">‚Üª Retake Quiz</button>
    </div>
  </div>

  <script>
    (function () {
      const modal        = document.getElementById('modal');
      const closeBtn     = document.getElementById('closeBtn');
      const btnStart     = document.getElementById('btnStart');
      const progressFill = document.getElementById('progressFill');
      const qStep        = document.getElementById('qStep');
      const qEmoji       = document.getElementById('qEmoji');
      const qText        = document.getElementById('qText');
      const choices      = document.getElementById('choicesContainer');
      const rEmoji       = document.getElementById('rEmoji');
      const rBadge       = document.getElementById('rBadge');
      const rTitle       = document.getElementById('rTitle');
      const rVibe        = document.getElementById('rVibe');
      const rDesc        = document.getElementById('rDesc');
      const promoWrapper = document.getElementById('promoWrapper');
      const promoCard    = document.getElementById('promoCard');
      const promoLabel   = document.getElementById('promoLabel');
      const promoCode    = document.getElementById('promoCode');
      const promoSubtext = document.getElementById('promoSubtext');
      const copyBtn      = document.getElementById('copyBtn');
      const copyInst     = document.getElementById('copyInstruction');
      const btnClaim     = document.getElementById('btnClaim');
      const btnRetake    = document.getElementById('btnRetake');

      const DISMISS = 'wzkr://thisleadstonowhere';
      let curQ = 0, scores = {};

      // ========== APPLY CONFIG ==========
      modal.style.background = CONFIG.background;
      if (!CONFIG.includeDismissButton) closeBtn.style.display = 'none';
      closeBtn.addEventListener('click', () => {
        pushEvent(CONFIG.events.quizDismissed, { Screen: activeScreen() });
        window.location.href = DISMISS;
      });

      document.getElementById('coverTitle').innerHTML = CONFIG.coverTitle.text;
      document.getElementById('coverTitle').style.fontSize = CONFIG.coverTitle.fontSize;
      document.getElementById('coverTitle').style.color = CONFIG.coverTitle.color;
      document.getElementById('coverSubtitle').textContent = CONFIG.coverSubtitle.text;
      document.getElementById('coverSubtitle').style.fontSize = CONFIG.coverSubtitle.fontSize;
      document.getElementById('coverSubtitle').style.color = CONFIG.coverSubtitle.color;
      btnStart.textContent = CONFIG.startButton.text;
      btnStart.style.background = CONFIG.startButton.background;
      btnStart.style.color = CONFIG.startButton.color;
      progressFill.style.background = CONFIG.accentColor;
      copyInst.style.color = CONFIG.copyInstruction.color;

      if (CONFIG.claimButton.enabled) {
        btnClaim.textContent = CONFIG.claimButton.text;
        btnClaim.style.background = CONFIG.claimButton.background;
        btnClaim.style.color = CONFIG.claimButton.color;
      } else { btnClaim.style.display = 'none'; }

      // ========== HELPERS ==========
      function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        const s = document.getElementById(id);
        s.classList.add('active');
        s.classList.remove('fade-in');
        void s.offsetWidth;
        s.classList.add('fade-in');
      }
      function activeScreen() {
        const s = document.querySelector('.screen.active');
        return s ? s.id.replace('screen-', '') : 'unknown';
      }

      // CleverTap (dual-SDK safe)
      function pushEvent(name, props) {
        if (!name) return;
        try {
          if (typeof clevertap !== 'undefined' && clevertap.event) clevertap.event.push(name, props || {});
          if (typeof CleverTap !== 'undefined' && CleverTap.event) CleverTap.event.push(name, props || {});
        } catch (e) { console.log('[CT]', name, props); }
      }
      function pushProfile(props) {
        try {
          if (typeof clevertap !== 'undefined' && clevertap.profile) clevertap.profile.push({ Site: props });
          if (typeof CleverTap !== 'undefined' && CleverTap.profile) CleverTap.profile.push({ Site: props });
        } catch (e) { console.log('[CT Profile]', props); }
      }

      // ========== QUIZ ENGINE ==========
      function startQuiz() {
        curQ = 0; scores = {};
        modal.className = 'modal on-q';
        modal.style.background = CONFIG.questionBackground;
        pushEvent(CONFIG.events.quizStarted, { Total_Questions: CONFIG.questions.length });
        showScreen('screen-question');
        renderQ();
      }

      function renderQ() {
        const q = CONFIG.questions[curQ];
        const total = CONFIG.questions.length;
        progressFill.style.width = (curQ / total * 100) + '%';
        qStep.textContent = (curQ + 1) + '/' + total;

        qEmoji.style.animation = 'none';
        void qEmoji.offsetWidth;
        qEmoji.style.animation = 'popIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1) forwards';
        qEmoji.textContent = q.emoji || '';
        qText.textContent = q.text;

        choices.innerHTML = '';
        q.choices.forEach((c, i) => {
          const btn = document.createElement('button');
          btn.className = 'choice-btn';
          btn.textContent = c.text;
          btn.style.background = CONFIG.choiceStyle.background;
          btn.style.border = CONFIG.choiceStyle.border;
          btn.style.color = CONFIG.choiceStyle.color;
          btn.style.fontSize = CONFIG.choiceStyle.fontSize;
          btn.addEventListener('mouseenter', () => {
            if (!btn.classList.contains('selected')) {
              btn.style.borderColor = CONFIG.choiceStyle.hoverBorder;
              btn.style.background = CONFIG.choiceStyle.hoverBackground;
            }
          });
          btn.addEventListener('mouseleave', () => {
            if (!btn.classList.contains('selected')) {
              btn.style.background = CONFIG.choiceStyle.background;
              btn.style.border = CONFIG.choiceStyle.border;
            }
          });
          btn.addEventListener('click', () => pick(i));
          choices.appendChild(btn);
        });
      }

      function pick(idx) {
        const c = CONFIG.questions[curQ].choices[idx];
        if (c.traits) Object.entries(c.traits).forEach(([t, p]) => { scores[t] = (scores[t] || 0) + p; });

        const btns = choices.querySelectorAll('.choice-btn');
        btns.forEach(b => {
          b.style.background = CONFIG.choiceStyle.background;
          b.style.border = CONFIG.choiceStyle.border;
          b.classList.remove('selected');
          b.style.pointerEvents = 'none';
        });
        btns[idx].classList.add('selected');
        btns[idx].style.borderColor = CONFIG.choiceStyle.selectedBorder;
        btns[idx].style.background = CONFIG.choiceStyle.selectedBackground;

        pushEvent(CONFIG.events.questionAnswered, { Question_Number: curQ + 1, Choice: c.text });

        setTimeout(() => {
          curQ++;
          if (curQ < CONFIG.questions.length) renderQ();
          else { progressFill.style.width = '100%'; showLoading(); }
        }, 380);
      }

      function showLoading() {
        modal.style.background = CONFIG.questionBackground;
        modal.className = 'modal';
        showScreen('screen-loading');
        setTimeout(showResult, 2600);
      }

      function showResult() {
        let best = '', hi = -1;
        Object.entries(scores).forEach(([t, s]) => { if (s > hi) { hi = s; best = t; } });
        const r = CONFIG.results[best];
        if (!r) return;

        modal.className = 'modal on-r';
        modal.style.background = r.bgGradient;
        document.documentElement.style.setProperty('--shimmer-hue-1', getHue(r.color) + 'deg');
        document.documentElement.style.setProperty('--shimmer-hue-2', getHue(r.color) + 'deg');

        rEmoji.textContent = r.emoji;
        rBadge.textContent = r.vibe;
        rBadge.style.background = r.color + '18';
        rBadge.style.color = r.color;
        rTitle.textContent = r.title;
        rVibe.textContent = '"' + r.vibe + '"';
        rVibe.style.color = r.color;
        rDesc.textContent = r.description;
        promoLabel.textContent = r.promoText;
        promoCode.textContent = r.promoCode;
        promoCode.style.color = r.color;
        promoSubtext.textContent = r.promoSubtext;
        promoCard.style.borderColor = r.color + '30';

        promoWrapper.classList.add('shimmer-active');
        promoCard.classList.add('pulsate');
        showScreen('screen-result');

        if (CONFIG.enableConfettiOnReveal) fireConfetti(r.color);

        pushEvent(CONFIG.events.quizCompleted, {
          Result: r.title, Result_Key: best, Promo_Code: r.promoCode,
          Questions_Answered: CONFIG.questions.length, Scores: JSON.stringify(scores),
        });
        pushProfile({
          SG_Driver_Personality: r.title, SG_Driver_Key: best, SG_Driver_Promo_Code: r.promoCode,
        });
      }

      function getHue(hex) {
        const r = parseInt(hex.slice(1, 3), 16) / 255, g = parseInt(hex.slice(3, 5), 16) / 255, b = parseInt(hex.slice(5, 7), 16) / 255;
        const mx = Math.max(r, g, b), mn = Math.min(r, g, b), d = mx - mn;
        let h = 0;
        if (d !== 0) { if (mx === r) h = ((g - b) / d) % 6; else if (mx === g) h = (b - r) / d + 2; else h = (r - g) / d + 4; }
        return Math.round(h * 60 + 360) % 360;
      }

      // ========== CLIPBOARD ==========
      function doCopy() {
        const t = promoCode.textContent;
        if (!t) return;
        if (navigator.clipboard && navigator.clipboard.writeText)
          navigator.clipboard.writeText(t).then(onCopied).catch(() => fbCopy(t));
        else fbCopy(t);
      }
      function onCopied() {
        copyInst.textContent = '‚úÖ Copied!';
        copyInst.style.color = CONFIG.copyInstruction.copiedColor;
        setTimeout(() => { copyInst.textContent = 'Tap to copy code'; copyInst.style.color = CONFIG.copyInstruction.color; }, 2000);
      }
      function fbCopy(t) {
        const inp = document.createElement('input');
        inp.setAttribute('readonly', ''); inp.value = t;
        inp.style.cssText = 'position:absolute;left:-9999px';
        document.body.appendChild(inp);
        if (/ipad|iphone/i.test(navigator.userAgent)) {
          const rng = document.createRange(); rng.selectNodeContents(inp);
          const sel = window.getSelection(); sel.removeAllRanges(); sel.addRange(rng);
          inp.setSelectionRange(0, t.length);
        } else { inp.focus(); inp.select(); }
        try { document.execCommand('copy'); onCopied(); } catch (e) { alert('Code: ' + t); }
        document.body.removeChild(inp);
      }
      copyBtn.addEventListener('click', e => { e.stopPropagation(); doCopy(); });
      promoCard.addEventListener('click', doCopy);

      // ========== CONFETTI ==========
      function fireConfetti(accent) {
        const colors = [accent || '#0142AF', '#FFD600', '#ffffff', '#0142AF', '#FFC107', '#4272C3'];
        const N = 120, grav = 0.3;
        const cv = document.createElement('canvas');
        cv.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:9999';
        document.body.appendChild(cv);
        const cx = cv.getContext('2d');
        cv.width = window.innerWidth; cv.height = window.innerHeight;
        const ps = [], rr = (a, b) => Math.random() * (b - a) + a;
        for (let i = 0; i < N; i++) ps.push({
          x: cv.width / 2, y: cv.height * 0.5,
          w: rr(5, 12), h: rr(7, 15),
          ang: rr(0, 360), tilt: rr(0.05, 0.12),
          col: colors[Math.floor(Math.random() * colors.length)],
          vx: rr(-10, 10), vy: rr(-16, -7),
          op: 1, dec: rr(0.007, 0.015),
        });
        function tick() {
          cx.clearRect(0, 0, cv.width, cv.height);
          for (let i = ps.length - 1; i >= 0; i--) {
            const p = ps[i]; p.x += p.vx; p.y += p.vy; p.vy += grav;
            p.op -= p.dec; p.ang += p.tilt * 180 / Math.PI;
            if (p.op <= 0 || p.y > cv.height + 20) { ps.splice(i, 1); continue; }
            cx.save(); cx.globalAlpha = Math.max(p.op, 0); cx.fillStyle = p.col;
            cx.translate(p.x, p.y); cx.rotate(p.ang * Math.PI / 180);
            cx.fillRect(-p.w / 2, -p.h / 2, p.w, p.h); cx.restore();
          }
          if (ps.length) requestAnimationFrame(tick); else cv.remove();
        }
        tick();
      }

      // ========== BUTTONS ==========
      btnStart.addEventListener('click', startQuiz);
      btnClaim.addEventListener('click', () => {
        pushEvent(CONFIG.events.resultClaimed, { Result: rTitle.textContent, Promo_Code: promoCode.textContent });
        if (CONFIG.claimButton.url) window.location.href = CONFIG.claimButton.url;
      });
      btnRetake.addEventListener('click', () => {
        modal.className = 'modal';
        modal.style.background = CONFIG.background;
        promoWrapper.classList.remove('shimmer-active');
        promoCard.classList.remove('pulsate');
        showScreen('screen-cover');
      });
    })();
  </script>
</body>
</html>
