<!DOCTYPE html>
<html lang="en">

<head>
  <script>
    const CONFIG = {
      includeDismissButton: true,

      brand: {
        name: "Evercare",
        tagline: "Family First",
        taglineSub: "é—œæ„›å¾å®¶é–‹å§‹",
        green: "#2AAF7F",
        greenDark: "#1A7A58",
        greenDeep: "#0F4D37",
        greenLight: "#D1FAE5",
        teal: "#0D9488",
        amber: "#F59E0B",
        amberLight: "#FEF3C7",
        cream: "#FFF8F0",
        warmWhite: "#FEFDFB",
        navy: "#1E293B",
        grey: "#64748B",
      },

      // ğŸ”® Fortune pool â€” daily wellness tips for caregivers & families
      // Bilingual: English primary, Chinese secondary
      fortunes: [
        { en: "A 10-minute walk today is a gift to your future self.", zh: "ä»Šå¤©èµ°ååˆ†é˜,æ˜¯çµ¦æœªä¾†è‡ªå·±çš„ç¦®ç‰©ã€‚", category: "movement" },
        { en: "The best medicine is a conversation with someone who truly listens.", zh: "æœ€å¥½çš„è‰¯è—¥,æ˜¯ä¸€å ´æœ‰äººçœŸå¿ƒå‚¾è½çš„å°è©±ã€‚", category: "connection" },
        { en: "Rest is not a reward. It's a requirement.", zh: "ä¼‘æ¯ä¸æ˜¯çè³,è€Œæ˜¯å¿…éœ€ã€‚", category: "rest" },
        { en: "Your loved ones don't need you perfect. They need you present.", zh: "å®¶äººä¸éœ€è¦ä½ å®Œç¾,åªéœ€è¦ä½ åœ¨èº«é‚Šã€‚", category: "presence" },
        { en: "Small acts of care compound into extraordinary health.", zh: "å¾®å°çš„é—œæ‡·,ç©å°‘æˆå¤šå°±æ˜¯å¥åº·ã€‚", category: "care" },
        { en: "Drinking one extra glass of water today will thank you tomorrow.", zh: "ä»Šå¤©å¤šå–ä¸€æ¯æ°´,æ˜å¤©èº«é«”æœƒæ„Ÿè¬ä½ ã€‚", category: "hydration" },
        { en: "Caring for others starts with caring for yourself first.", zh: "ç…§é¡§åˆ¥äºº,å…ˆå¾ç…§é¡§è‡ªå·±é–‹å§‹ã€‚", category: "self-care" },
        { en: "A deep breath costs nothing but gives you everything.", zh: "æ·±å‘¼å¸ä¸èŠ±ä¸€åˆ†éŒ¢,å»çµ¦ä½ ä¸€åˆ‡ã€‚", category: "mindfulness" },
        { en: "Today is a good day to call someone you haven't spoken to in a while.", zh: "ä»Šå¤©æ˜¯å€‹å¥½æ—¥å­,æ‰“å€‹é›»è©±çµ¦å¾ˆä¹…æ²’è¯ç¹«çš„äººå§ã€‚", category: "connection" },
        { en: "Progress, not perfection, is the path to wellness.", zh: "é€²æ­¥,è€Œéå®Œç¾,æ‰æ˜¯é€šå¾€å¥åº·çš„è·¯ã€‚", category: "growth" },
        { en: "Your body keeps the score. Give it a gentle stretch today.", zh: "èº«é«”è¨˜ä½ä¸€åˆ‡,ä»Šå¤©çµ¦å®ƒä¸€å€‹æº«æŸ”çš„ä¼¸å±•å§ã€‚", category: "movement" },
        { en: "The most powerful health tool? A consistent bedtime.", zh: "æœ€å¼·å¤§çš„å¥åº·å·¥å…·?å›ºå®šçš„å°±å¯¢æ™‚é–“ã€‚", category: "rest" },
        { en: "Kindness to yourself is the foundation of kindness to others.", zh: "å–„å¾…è‡ªå·±,æ‰æ˜¯å–„å¾…ä»–äººçš„æ ¹åŸºã€‚", category: "self-care" },
        { en: "A shared meal is shared medicine for the soul.", zh: "ä¸€é “å…±äº«çš„é£¯,æ˜¯å¿ƒéˆçš„å…±äº«è‰¯è—¥ã€‚", category: "connection" },
        { en: "Worry less about the diagnosis. Focus on the daily choices.", zh: "å°‘æ“”å¿ƒè¨ºæ–·çµæœ,å¤šå°ˆæ³¨æ¯å¤©çš„é¸æ“‡ã€‚", category: "mindfulness" },
        { en: "The hands that care for others deserve to be held too.", zh: "ç…§é¡§åˆ¥äººçš„é›™æ‰‹,ä¹Ÿå€¼å¾—è¢«æ¡ä½ã€‚", category: "care" },
        { en: "Five minutes of sunlight can shift your entire day.", zh: "äº”åˆ†é˜çš„é™½å…‰,èƒ½æ”¹è®Šä½ çš„ä¸€æ•´å¤©ã€‚", category: "movement" },
        { en: "Health is not about adding years to life, but life to years.", zh: "å¥åº·ä¸æ˜¯å»¶é•·å£½å‘½,è€Œæ˜¯è±å¯Œæ¯ä¸€å¹´ã€‚", category: "growth" },
        { en: "Let go of one thing on your worry list today. Just one.", zh: "ä»Šå¤©æ”¾ä¸‹ä¸€ä»¶æ“”å¿ƒçš„äº‹,å°±ä¸€ä»¶ã€‚", category: "mindfulness" },
        { en: "The best caregivers are the ones who know when to ask for help.", zh: "æœ€å¥½çš„ç…§é¡§è€…,çŸ¥é“ä»€éº¼æ™‚å€™è©²æ±‚åŠ©ã€‚", category: "self-care" },
        { en: "Laughter is a vital sign. Make sure you're getting enough.", zh: "ç¬‘è²æ˜¯ç”Ÿå‘½é«”å¾µ,ç¢ºä¿ä½ æœ‰è¶³å¤ çš„é‡ã€‚", category: "connection" },
        { en: "Your morning routine sets the compass for your whole day.", zh: "ä½ çš„æ™¨é–“ç¿’æ…£,æ±ºå®šäº†ä¸€æ•´å¤©çš„æ–¹å‘ã€‚", category: "growth" },
        { en: "A hug lowers blood pressure. Science says so.", zh: "æ“æŠ±èƒ½é™ä½è¡€å£“,é€™æ˜¯ç§‘å­¸è­‰æ˜çš„ã€‚", category: "connection" },
        { en: "Healing doesn't happen in a straight line. Be patient.", zh: "åº·å¾©ä¸æ˜¯ä¸€æ¢ç›´ç·š,è¦æœ‰è€å¿ƒã€‚", category: "care" },
        { en: "Put the phone down 30 minutes before bed. Your brain will thank you.", zh: "ç¡å‰æ”¾ä¸‹æ‰‹æ©Ÿä¸‰ååˆ†é˜,å¤§è…¦æœƒæ„Ÿè¬ä½ ã€‚", category: "rest" },
        { en: "One balanced meal today is worth more than a perfect diet tomorrow.", zh: "ä»Šå¤©ä¸€é “å‡è¡¡çš„é£¯,å‹éæ˜å¤©å®Œç¾çš„é£Ÿè­œã€‚", category: "hydration" },
        { en: "Your family's health story is still being written. You hold the pen.", zh: "å®¶äººçš„å¥åº·æ•…äº‹ä»åœ¨æ›¸å¯«,ç­†åœ¨ä½ æ‰‹ä¸­ã€‚", category: "growth" },
        { en: "Sometimes the bravest thing is to sit still and breathe.", zh: "æœ‰æ™‚å€™æœ€å‹‡æ•¢çš„äº‹,å°±æ˜¯éœéœåä¸‹ä¾†å‘¼å¸ã€‚", category: "mindfulness" },
        { en: "Movement is medicine. Even just standing up counts.", zh: "é‹å‹•å°±æ˜¯è—¥ã€‚å“ªæ€•åªæ˜¯ç«™èµ·ä¾†ä¹Ÿç®—ã€‚", category: "movement" },
        { en: "Home is where healing begins. Make it gentle.", zh: "å®¶æ˜¯åº·å¾©çš„èµ·é»,è®“å®ƒæº«æŸ”ä¸€äº›ã€‚", category: "care" },
      ],

      // ğŸ¨ Daily wellness colors (cycled by day)
      wellnessColors: [
        { name: "Sage Green",    nameZh: "é¼ å°¾è‰ç¶ ", hex: "#86EFAC", mood: "Balance",     moodZh: "å¹³è¡¡" },
        { name: "Calm Blue",     nameZh: "å¯§éœè—",   hex: "#93C5FD", mood: "Tranquility", moodZh: "å¯§éœ" },
        { name: "Warm Peach",    nameZh: "æš–æ¡ƒè‰²",   hex: "#FDBA74", mood: "Comfort",     moodZh: "æº«æš–" },
        { name: "Soft Lavender", nameZh: "æ·¡ç´«è‰²",   hex: "#C4B5FD", mood: "Serenity",    moodZh: "å®‰è©³" },
        { name: "Rose Quartz",   nameZh: "ç«ç‘°ç²‰",   hex: "#FDA4AF", mood: "Compassion",  moodZh: "æ…ˆæ‚²" },
        { name: "Morning Gold",  nameZh: "æ™¨å…‰é‡‘",   hex: "#FDE68A", mood: "Optimism",    moodZh: "æ¨‚è§€" },
        { name: "Ocean Teal",    nameZh: "æµ·æ´‹é’",   hex: "#5EEAD4", mood: "Renewal",     moodZh: "é‡ç”Ÿ" },
      ],

      // ğŸ“Š Category icons
      categoryIcons: {
        movement: "ğŸš¶",
        connection: "ğŸ’›",
        rest: "ğŸ˜´",
        presence: "ğŸ¤²",
        care: "ğŸ©º",
        hydration: "ğŸ’§",
        "self-care": "ğŸŒ¿",
        mindfulness: "ğŸ§˜",
        growth: "ğŸŒ±",
      },

      cta: {
        text: "Book a Care Consultation",
        textZh: "é ç´„è­·ç†è«®è©¢",
        url: "evercare://book",
      },

      // ğŸ”¥ Streak data (in production: pulled from CleverTap profile properties)
      streak: {
        currentStreak: 5,       // days in a row user has opened fortune
        longestStreak: 12,      // all-time best
        totalRevealed: 27,      // lifetime fortunes opened
      },

      events: {
        fortuneViewed:    "Fortune_Viewed",
        fortuneRevealed:  "Fortune_Revealed",
        fortuneShared:    "Fortune_Shared",
        fortuneCta:       "Fortune_CTA",
        fortuneDismissed: "Fortune_Dismissed",
      },
    };
  </script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Evercare â€” Daily Wellness Fortune</title>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Inter:wght@400;500;600;700&display=swap');

    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    html, body {
      width: 100%; height: 100%;
      font-family: 'Inter', -apple-system, sans-serif;
      -webkit-font-smoothing: antialiased;
      overflow: hidden;
      background: #0F4D37;
    }

    .modal {
      width: 100%; height: 100%;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      padding: 24px 20px;
      position: relative; overflow: hidden;
      background: linear-gradient(170deg, #FFF8F0 0%, #FEFDFB 40%, #F0FDF4 100%);
    }

    .dismiss-btn {
      position: fixed; top: 12px; right: 12px;
      width: 30px; height: 30px; border-radius: 50%;
      background: rgba(0,0,0,0.06); border: none;
      color: rgba(0,0,0,0.3); font-size: 14px;
      cursor: pointer; z-index: 100;
      display: flex; align-items: center; justify-content: center;
      -webkit-tap-highlight-color: transparent;
    }

    .content {
      width: 100%; max-width: 360px;
      display: flex; flex-direction: column;
      align-items: center; text-align: center;
    }

    /* =============================================
       SCREEN 1: SEALED CARD
       ============================================= */
    .sealed-screen { display: flex; flex-direction: column; align-items: center; }
    .sealed-screen.hide { display: none; }

    .brand-tag {
      font-size: 10px; font-weight: 700;
      color: #2AAF7F;
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 6px;
    }

    .sealed-title {
      font-family: 'DM Serif Display', serif;
      font-size: 22px; color: #1E293B;
      line-height: 1.25; margin-bottom: 4px;
    }
    .sealed-subtitle {
      font-size: 12px; color: #64748B;
      margin-bottom: 24px;
    }

    /* Streak banner */
    .streak-banner {
      display: inline-flex; align-items: center; gap: 6px;
      background: rgba(42,175,127,0.08);
      border: 1px solid rgba(42,175,127,0.15);
      border-radius: 100px;
      padding: 6px 14px;
      margin-bottom: 14px;
      animation: fadeIn 0.5s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    .streak-fire { font-size: 14px; }
    .streak-count {
      font-size: 16px; font-weight: 800;
      color: #1E293B;
    }
    .streak-label {
      font-size: 11px; font-weight: 600;
      color: #2AAF7F;
    }
    .streak-divider {
      color: #CBD5E1; font-size: 10px;
    }
    .streak-best {
      font-size: 10px; font-weight: 600;
      color: #94A3B8;
    }

    /* Already revealed today state */
    .already-opened { display: none; flex-direction: column; align-items: center; }
    .already-opened.show { display: flex; }

    .ao-card {
      width: 100%;
      background: #FFFFFF;
      border-radius: 20px;
      padding: 24px 20px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.04);
      border: 1px solid rgba(42,175,127,0.1);
      margin-bottom: 14px;
    }
    .ao-emoji { font-size: 40px; margin-bottom: 8px; }
    .ao-title {
      font-family: 'DM Serif Display', serif;
      font-size: 18px; color: #1E293B;
      margin-bottom: 4px;
    }
    .ao-sub {
      font-size: 12px; color: #94A3B8;
      margin-bottom: 14px;
    }
    .ao-fortune {
      font-family: 'DM Serif Display', serif;
      font-size: 15px; color: #2AAF7F;
      line-height: 1.4;
      font-style: italic;
      padding: 0 8px;
      margin-bottom: 4px;
    }
    .ao-fortune-zh {
      font-size: 12px; color: #94A3B8;
      margin-bottom: 14px;
    }
    .ao-countdown {
      font-size: 11px; font-weight: 600;
      color: #64748B;
    }
    .ao-countdown span {
      color: #2AAF7F; font-weight: 800;
    }

    /* The sealed card itself */
    .card-wrapper {
      perspective: 800px;
      margin-bottom: 20px;
    }

    .sealed-card {
      width: 220px; height: 300px;
      border-radius: 20px;
      position: relative; cursor: pointer;
      transform-style: preserve-3d;
      animation: cardFloat 3s ease-in-out infinite;
      transition: transform 0.15s ease;
      -webkit-tap-highlight-color: transparent;
    }
    .sealed-card:active { transform: scale(0.97); }

    @keyframes cardFloat {
      0%, 100% { transform: translateY(0) rotateY(-2deg); }
      50% { transform: translateY(-6px) rotateY(2deg); }
    }

    .card-face {
      position: absolute; top: 0; left: 0;
      width: 100%; height: 100%;
      border-radius: 20px;
      background: linear-gradient(145deg, #2AAF7F 0%, #1A7A58 40%, #0F4D37 100%);
      box-shadow:
        0 15px 40px rgba(42,175,127,0.3),
        0 5px 15px rgba(0,0,0,0.1),
        inset 0 1px 0 rgba(255,255,255,0.15);
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      overflow: hidden;
    }

    /* Decorative pattern overlay */
    .card-face::before {
      content: '';
      position: absolute; top: 0; left: 0;
      width: 100%; height: 100%;
      background:
        radial-gradient(circle at 30% 20%, rgba(255,255,255,0.08) 0%, transparent 50%),
        radial-gradient(circle at 70% 80%, rgba(255,255,255,0.05) 0%, transparent 40%);
      pointer-events: none;
    }

    /* Shimmer sweep */
    .card-face::after {
      content: '';
      position: absolute; top: -100%; left: -100%;
      width: 300%; height: 300%;
      background: linear-gradient(
        105deg,
        transparent 0%,
        rgba(255,255,255,0.03) 35%,
        rgba(255,255,255,0.08) 50%,
        rgba(255,255,255,0.03) 65%,
        transparent 100%
      );
      animation: cardShimmer 4s ease-in-out infinite;
      pointer-events: none;
    }
    @keyframes cardShimmer {
      0% { transform: translateX(-50%) rotate(25deg); }
      100% { transform: translateX(50%) rotate(25deg); }
    }

    .card-icon {
      font-size: 48px; margin-bottom: 12px;
      filter: drop-shadow(0 4px 12px rgba(0,0,0,0.2));
      position: relative; z-index: 1;
    }

    .card-brand {
      font-size: 18px; font-weight: 700;
      color: #FFFFFF;
      letter-spacing: 0.5px;
      position: relative; z-index: 1;
    }

    .card-label {
      font-size: 10px; font-weight: 600;
      color: rgba(255,255,255,0.5);
      text-transform: uppercase;
      letter-spacing: 1.5px;
      margin-top: 4px;
      position: relative; z-index: 1;
    }

    /* Seal / wax stamp */
    .card-seal {
      width: 44px; height: 44px;
      border-radius: 50%;
      background: linear-gradient(135deg, #F59E0B, #D97706);
      box-shadow: 0 2px 8px rgba(245,158,11,0.4);
      display: flex; align-items: center; justify-content: center;
      font-size: 18px; color: #FFF;
      margin-top: 16px;
      position: relative; z-index: 1;
      animation: sealPulse 2s ease-in-out infinite;
    }
    @keyframes sealPulse {
      0%, 100% { box-shadow: 0 2px 8px rgba(245,158,11,0.4); }
      50% { box-shadow: 0 2px 8px rgba(245,158,11,0.4), 0 0 0 6px rgba(245,158,11,0.1); }
    }

    .tap-hint {
      font-size: 12px; font-weight: 600;
      color: #2AAF7F;
      animation: tapBlink 2s ease-in-out infinite;
    }
    @keyframes tapBlink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.4; }
    }
    .tap-hint-sub {
      font-size: 10px; color: #94A3B8;
    }

    /* =============================================
       CRACK ANIMATION
       ============================================= */
    .sealed-card.cracking {
      animation: cardCrack 0.6s ease forwards;
    }
    @keyframes cardCrack {
      0% { transform: scale(1) rotate(0); }
      30% { transform: scale(1.05) rotate(-2deg); }
      60% { transform: scale(0.95) rotate(1deg); }
      100% { transform: scale(0) rotate(5deg); opacity: 0; }
    }

    /* =============================================
       SCREEN 2: REVEALED FORTUNE
       ============================================= */
    .fortune-screen { display: none; flex-direction: column; align-items: center; }
    .fortune-screen.show {
      display: flex;
      animation: fortuneEnter 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    }
    @keyframes fortuneEnter {
      from { opacity: 0; transform: translateY(20px) scale(0.95); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    .fortune-label {
      font-size: 10px; font-weight: 700;
      color: #2AAF7F;
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 10px;
    }

    .fortune-card {
      width: 100%;
      background: #FFFFFF;
      border-radius: 20px;
      padding: 28px 24px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.06), 0 1px 3px rgba(0,0,0,0.04);
      border: 1px solid rgba(42,175,127,0.1);
      margin-bottom: 14px;
      position: relative;
      overflow: hidden;
    }

    /* Subtle leaf watermark */
    .fortune-card::before {
      content: 'ğŸŒ¿';
      position: absolute; bottom: -5px; right: -5px;
      font-size: 80px; opacity: 0.04;
      transform: rotate(-15deg);
      pointer-events: none;
    }

    .fortune-category {
      display: inline-flex; align-items: center; gap: 4px;
      font-size: 11px; font-weight: 600;
      color: #2AAF7F;
      background: rgba(42,175,127,0.08);
      padding: 4px 10px; border-radius: 100px;
      margin-bottom: 14px;
    }

    .fortune-text-en {
      font-family: 'DM Serif Display', serif;
      font-size: 20px; color: #1E293B;
      line-height: 1.4;
      margin-bottom: 8px;
      opacity: 0;
      animation: typeIn 0.8s ease 0.3s forwards;
    }
    @keyframes typeIn {
      from { opacity: 0; transform: translateY(6px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .fortune-text-zh {
      font-size: 14px; color: #64748B;
      line-height: 1.5;
      opacity: 0;
      animation: typeIn 0.8s ease 0.5s forwards;
    }

    /* =============================================
       WELLNESS DETAILS ROW
       ============================================= */
    .wellness-row {
      display: flex; gap: 8px;
      width: 100%;
      margin-bottom: 14px;
      opacity: 0;
      animation: typeIn 0.6s ease 0.7s forwards;
    }

    .wellness-chip {
      flex: 1;
      background: #FFFFFF;
      border: 1px solid rgba(0,0,0,0.06);
      border-radius: 14px;
      padding: 12px 8px;
      text-align: center;
    }
    .wc-icon { font-size: 16px; margin-bottom: 2px; }
    .wc-value {
      font-size: 13px; font-weight: 700;
      color: #1E293B;
    }
    .wc-label {
      font-size: 8px; font-weight: 600;
      color: #94A3B8;
      text-transform: uppercase;
      letter-spacing: 0.3px;
      margin-top: 1px;
    }

    /* Color swatch */
    .color-swatch {
      width: 20px; height: 20px;
      border-radius: 50%;
      display: inline-block;
      border: 2px solid rgba(255,255,255,0.8);
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    /* =============================================
       BUTTONS
       ============================================= */
    .btn-row {
      display: flex; gap: 10px;
      width: 100%;
      opacity: 0;
      animation: typeIn 0.6s ease 0.9s forwards;
    }

    .btn {
      flex: 1; padding: 14px;
      border-radius: 14px; border: none;
      font-family: inherit;
      font-size: 13px; font-weight: 700;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
      transition: all 0.2s ease;
    }
    .btn:active { transform: scale(0.97); }

    .btn-primary {
      background: #2AAF7F; color: #FFFFFF;
      box-shadow: 0 4px 12px rgba(42,175,127,0.25);
    }

    .btn-share {
      background: rgba(0,0,0,0.04);
      color: #64748B;
      border: 1px solid rgba(0,0,0,0.06);
      flex: 0.55;
    }

    .btn-collect {
      width: 100%;
      margin-top: 8px;
      padding: 10px;
      background: transparent; border: none;
      font-family: inherit;
      font-size: 11px; font-weight: 600;
      color: #94A3B8;
      cursor: pointer;
    }

    /* =============================================
       SHARE CARD (bottom sheet)
       ============================================= */
    .share-backdrop {
      display: none;
      position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.4);
      z-index: 250;
    }
    .share-backdrop.show { display: block; }

    .share-card {
      display: none;
      position: fixed; bottom: 0; left: 0; right: 0;
      background: #FFFFFF;
      border-radius: 24px 24px 0 0;
      padding: 28px 24px 32px;
      text-align: center;
      z-index: 300;
      transform: translateY(100%);
      transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    }
    .share-card.show {
      display: block;
      transform: translateY(0);
    }

    .sc-pill {
      width: 36px; height: 4px;
      background: rgba(0,0,0,0.1);
      border-radius: 100px;
      margin: 0 auto 16px;
    }

    .sc-fortune {
      font-family: 'DM Serif Display', serif;
      font-size: 16px; color: #1E293B;
      line-height: 1.4;
      margin-bottom: 4px;
      max-width: 280px;
      margin-left: auto; margin-right: auto;
    }
    .sc-fortune-zh {
      font-size: 12px; color: #94A3B8;
      margin-bottom: 14px;
    }

    .sc-detail-row {
      display: flex; justify-content: center; gap: 16px;
      margin-bottom: 16px;
    }
    .sc-detail {
      font-size: 10px; font-weight: 600;
      color: #64748B;
      display: flex; align-items: center; gap: 4px;
    }

    .sc-watermark {
      font-size: 9px; font-weight: 600;
      color: #CBD5E1;
      margin-bottom: 14px;
    }

    .sc-actions { display: flex; gap: 10px; }
    .sc-btn {
      flex: 1; padding: 12px;
      border-radius: 12px; border: none;
      font-family: inherit;
      font-size: 13px; font-weight: 700;
      cursor: pointer;
    }
    .sc-btn-share { background: #2AAF7F; color: #FFF; }
    .sc-btn-close { background: rgba(0,0,0,0.04); color: #64748B; }

    /* =============================================
       PARTICLES
       ============================================= */
    #particleCanvas {
      position: fixed; top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none; z-index: 500;
    }

    .hidden { display: none !important; }

    /* ğŸ§ª Test panel â€” only shows when ?test=true */
    .test-panel {
      display: none;
      position: fixed; bottom: 10px; left: 10px; right: 10px;
      background: rgba(0,0,0,0.88);
      border-radius: 12px;
      padding: 10px 14px;
      z-index: 9999;
      font-size: 11px; color: #FFF;
      backdrop-filter: blur(10px);
    }
    .test-panel.show { display: block; }
    .tp-row {
      display: flex; align-items: center;
      justify-content: space-between;
      gap: 8px;
    }
    .tp-label {
      font-weight: 600; color: #94A3B8;
      font-size: 9px; text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .tp-info {
      font-weight: 700; color: #34D399;
      font-size: 12px;
      flex: 1; text-align: center;
    }
    .tp-btn {
      background: rgba(255,255,255,0.12); border: none;
      color: #FFF; padding: 6px 12px;
      border-radius: 6px; font-size: 12px;
      font-weight: 700; cursor: pointer;
      font-family: inherit;
    }
    .tp-btn:active { background: rgba(255,255,255,0.2); }
    .tp-row2 {
      display: flex; gap: 6px;
      margin-top: 6px;
    }
    .tp-btn-sm {
      flex: 1; padding: 5px;
      background: rgba(255,255,255,0.08); border: none;
      color: #94A3B8; font-size: 9px;
      font-weight: 600; border-radius: 6px;
      cursor: pointer; font-family: inherit;
    }
    .tp-btn-sm:active { background: rgba(255,255,255,0.15); color: #FFF; }
  </style>
</head>

<body>
  <!-- ğŸ§ª Test Panel â€” add ?test=true to URL to show -->
  <div class="test-panel" id="testPanel">
    <div class="tp-row">
      <button class="tp-btn" onclick="testNav(-1)">Ã¢â€”â‚¬ Prev</button>
      <div>
        <div class="tp-label">Fortune</div>
        <div class="tp-info" id="tpInfo">0 / 30</div>
      </div>
      <button class="tp-btn" onclick="testNav(1)">Next Ã¢â€“Â¶</button>
    </div>
    <div class="tp-row2">
      <button class="tp-btn-sm" onclick="testGo(0)">First</button>
      <button class="tp-btn-sm" onclick="testGo(14)">Mid</button>
      <button class="tp-btn-sm" onclick="testGo(29)">Last</button>
      <button class="tp-btn-sm" onclick="testRevealed()">Locked</button>
      <button class="tp-btn-sm" onclick="testStreak(1)">Streak 1</button>
      <button class="tp-btn-sm" onclick="testStreak(30)">Streak 30</button>
    </div>
  </div>

  <canvas id="particleCanvas"></canvas>

  <div class="modal" id="modal">
    <button class="dismiss-btn" id="dismissBtn" onclick="dismiss()">âœ•</button>

    <div class="content">

      <!-- ==========================================
           SCREEN 1: SEALED
           ========================================== -->
      <div class="sealed-screen" id="sealedScreen">
        <div class="brand-tag">Evercare Â· Family First</div>

        <!-- Streak banner -->
        <div class="streak-banner" id="streakBanner">
          <span class="streak-fire">ğŸ”¥</span>
          <span class="streak-count" id="streakCount">5</span>
          <span class="streak-label">day streak</span>
          <span class="streak-divider">Â·</span>
          <span class="streak-best" id="streakBest">Best: 12</span>
        </div>

        <div class="sealed-title">Today's Wellness<br>Fortune Awaits</div>
        <div class="sealed-subtitle">ä»Šæ—¥å¥åº·éŒ¦å›Šç­‰ä½ æ­æ›‰</div>

        <div class="card-wrapper">
          <div class="sealed-card" id="sealedCard" onclick="crackOpen()">
            <div class="card-face">
              <span class="card-icon">ğŸŒ¿</span>
              <span class="card-brand">Evercare</span>
              <span class="card-label">Daily Wellness</span>
              <div class="card-seal">âœ¦</div>
            </div>
          </div>
        </div>

        <div class="tap-hint">Tap to reveal your fortune</div>
        <div class="tap-hint-sub">é»æ“Šæ­æ›‰ä½ çš„æ¯æ—¥éŒ¦å›Š</div>
      </div>

      <!-- ==========================================
           SCREEN 2: REVEALED FORTUNE
           ========================================== -->
      <div class="fortune-screen" id="fortuneScreen">
        <div class="fortune-label">Your Wellness Fortune Â· ä»Šæ—¥éŒ¦å›Š</div>

        <!-- Streak badge on revealed screen -->
        <div class="streak-banner" style="margin-bottom:12px">
          <span class="streak-fire">ğŸ”¥</span>
          <span class="streak-count" id="streakCount2">5</span>
          <span class="streak-label">day streak!</span>
        </div>

        <div class="fortune-card">
          <div class="fortune-category" id="fCategory"></div>
          <div class="fortune-text-en" id="fTextEn"></div>
          <div class="fortune-text-zh" id="fTextZh"></div>
        </div>

      <!-- ==========================================
           SCREEN 3: ALREADY OPENED TODAY
           ========================================== -->
      <div class="already-opened" id="alreadyScreen">
        <div class="brand-tag">Evercare Â· Family First</div>

        <div class="streak-banner" style="margin-bottom:14px">
          <span class="streak-fire">ğŸ”¥</span>
          <span class="streak-count" id="streakCount3">5</span>
          <span class="streak-label">day streak</span>
          <span class="streak-divider">Â·</span>
          <span class="streak-best" id="streakBest3">Best: 12</span>
        </div>

        <div class="ao-card">
          <div class="ao-emoji">ğŸŒ¿</div>
          <div class="ao-title">Today's Fortune Revealed</div>
          <div class="ao-sub">ä½ ä»Šå¤©çš„éŒ¦å›Šå·²æ­æ›‰</div>
          <div class="ao-fortune" id="aoFortune"></div>
          <div class="ao-fortune-zh" id="aoFortuneZh"></div>
          <div class="ao-countdown" id="aoCountdown">Next fortune in <span id="aoTimer">--:--:--</span></div>
        </div>

        <div class="btn-row" style="opacity:1;">
          <button class="btn btn-primary" onclick="ctaClick()">Book a Consultation</button>
          <button class="btn btn-share" onclick="showShareCardFromAO()">Share ğŸ”—</button>
        </div>

        <button class="btn-collect" onclick="dismiss()">Close Â· é—œé–‰</button>
      </div>

        <!-- Wellness details -->
        <div class="wellness-row">
          <div class="wellness-chip">
            <div class="wc-icon">ğŸ”¢</div>
            <div class="wc-value" id="wLucky">7</div>
            <div class="wc-label">Lucky No.</div>
          </div>
          <div class="wellness-chip">
            <div class="wc-icon" id="wColorIcon"></div>
            <div class="wc-value" id="wColorName">Sage</div>
            <div class="wc-label">Today's Color</div>
          </div>
          <div class="wellness-chip">
            <div class="wc-icon">ğŸ§˜</div>
            <div class="wc-value" id="wMood">Balance</div>
            <div class="wc-label">Self-Care Focus</div>
          </div>
        </div>

        <!-- Buttons -->
        <div class="btn-row">
          <button class="btn btn-primary" onclick="ctaClick()">Book a Consultation</button>
          <button class="btn btn-share" onclick="showShareCard()">Share ğŸ”—</button>
        </div>

        <button class="btn-collect" onclick="dismiss()">Save & Close Â· æ”¶è—ä¸¦é—œé–‰</button>
      </div>
    </div>
  </div>

  <!-- Share bottom sheet -->
  <div class="share-backdrop" id="shareBackdrop" onclick="hideShareCard()"></div>
  <div class="share-card" id="shareCard">
    <div class="sc-pill"></div>
    <div class="sc-fortune" id="scFortune"></div>
    <div class="sc-fortune-zh" id="scFortuneZh"></div>
    <div class="sc-detail-row">
      <div class="sc-detail"><span id="scColor"></span> <span id="scColorName"></span></div>
      <div class="sc-detail">ğŸ”¢ <span id="scLucky"></span></div>
      <div class="sc-detail">ğŸ§˜ <span id="scMood"></span></div>
    </div>
    <div class="sc-watermark">Evercare Â· Family First Â· é—œæ„›å¾å®¶é–‹å§‹</div>
    <div class="sc-actions">
      <button class="sc-btn sc-btn-share" onclick="shareNow()">Share</button>
      <button class="sc-btn sc-btn-close" onclick="hideShareCard()">Close</button>
    </div>
  </div>

  <script>
    // =============================================
    // STATE
    // =============================================
    const fortunes = CONFIG.fortunes;
    const colors = CONFIG.wellnessColors;
    const icons = CONFIG.categoryIcons;
    const streak = CONFIG.streak;

    // Deterministic "daily" selection using date
    const today = new Date();
    const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / 86400000);

    // =============================================
    // ğŸ§ª TEST MODE â€” URL params override defaults
    //
    //   ?day=0       â†’ force fortune index 0 (first fortune)
    //   ?day=14      â†’ force fortune index 14
    //   ?streak=25   â†’ override streak count
    //   ?best=30     â†’ override best streak
    //   ?revealed=true â†’ show "already opened" state
    //
    //   Examples:
    //   file.html?day=0
    //   file.html?day=5&streak=10&best=15
    //   file.html?day=12&revealed=true
    //   file.html?day=29  (last fortune in pool)
    //
    //   Cycle all 30: just change ?day=0 through ?day=29
    // =============================================
    const urlParams = new URLSearchParams(window.location.search);

    const testDay = urlParams.get('day');
    const forcedIndex = testDay !== null ? parseInt(testDay, 10) : null;

    const fortuneIndex = forcedIndex !== null ? (forcedIndex % fortunes.length) : (dayOfYear % fortunes.length);
    const colorIndex = forcedIndex !== null ? (forcedIndex % colors.length) : (dayOfYear % colors.length);
    const luckyNumber = forcedIndex !== null
      ? (((forcedIndex + 1) * 7 + 3) % 88) + 1
      : ((dayOfYear * 7 + 3) % 88) + 1;

    // Override streak values from URL
    if (urlParams.get('streak')) streak.currentStreak = parseInt(urlParams.get('streak'), 10);
    if (urlParams.get('best')) streak.longestStreak = parseInt(urlParams.get('best'), 10);

    const todayFortune = fortunes[fortuneIndex];
    const todayColor = colors[colorIndex];
    const todayKey = today.toISOString().slice(0, 10);

    if (!CONFIG.includeDismissButton) {
      document.getElementById('dismissBtn').classList.add('hidden');
    }

    // Populate streak counts on all screens
    document.getElementById('streakCount').textContent = streak.currentStreak;
    document.getElementById('streakBest').textContent = 'Best: ' + streak.longestStreak;
    document.getElementById('streakCount2').textContent = streak.currentStreak;
    document.getElementById('streakCount3').textContent = streak.currentStreak;
    document.getElementById('streakBest3').textContent = 'Best: ' + streak.longestStreak;

    // =============================================
    // DATE LOCK â€” Check if already revealed today
    // In production: use CleverTap profile prop "Last_Fortune_Date"
    // Here: use a simple variable simulating the check
    // Set alreadyRevealedToday = true to preview the locked state
    // =============================================
    let alreadyRevealedToday = false;

    // Check via CleverTap profile prop or campaign variable
    // In demo: reads from URL param ?revealed=true for testing
    if (urlParams.get('revealed') === 'true') {
      alreadyRevealedToday = true;
    }

    function showAlreadyOpenedState() {
      document.getElementById('sealedScreen').classList.add('hide');
      document.getElementById('fortuneScreen').style.display = 'none';
      const ao = document.getElementById('alreadyScreen');
      ao.classList.add('show');

      document.getElementById('aoFortune').textContent = '"' + todayFortune.en + '"';
      document.getElementById('aoFortuneZh').textContent = todayFortune.zh;

      // Start countdown to midnight
      updateCountdown();
      setInterval(updateCountdown, 1000);
    }

    function updateCountdown() {
      const now = new Date();
      const midnight = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1, 0, 0, 0);
      const diff = midnight - now;
      const h = String(Math.floor(diff / 3600000)).padStart(2, '0');
      const m = String(Math.floor((diff % 3600000) / 60000)).padStart(2, '0');
      const s = String(Math.floor((diff % 60000) / 1000)).padStart(2, '0');
      const timerEl = document.getElementById('aoTimer');
      if (timerEl) timerEl.textContent = h + ':' + m + ':' + s;
    }

    // Init: check date lock
    if (alreadyRevealedToday) {
      showAlreadyOpenedState();
    }

    // Fire viewed event
    pushEvent(CONFIG.events.fortuneViewed, {
      Fortune_Index: fortuneIndex,
      Day_Of_Year: dayOfYear,
      Already_Revealed: alreadyRevealedToday,
      Streak: streak.currentStreak,
    });

    // =============================================
    // CRACK OPEN
    // =============================================
    let revealed = false;

    window.crackOpen = function () {
      if (revealed || alreadyRevealedToday) return;
      revealed = true;

      // Mark as revealed today (in production: write to CleverTap profile)
      // CleverTap profile update: { Last_Fortune_Date: todayKey, Fortune_Streak: streak.currentStreak + 1 }
      alreadyRevealedToday = true;

      const card = document.getElementById('sealedCard');
      card.classList.add('cracking');

      // Burst particles
      setTimeout(burstParticles, 300);

      // Transition screens
      setTimeout(() => {
        document.getElementById('sealedScreen').classList.add('hide');
        const fs = document.getElementById('fortuneScreen');
        fs.classList.add('show');
        populateFortune();
      }, 600);

      pushEvent(CONFIG.events.fortuneRevealed, {
        Fortune_Index: fortuneIndex,
        Fortune_EN: todayFortune.en,
        Category: todayFortune.category,
        Lucky_Number: luckyNumber,
        Wellness_Color: todayColor.name,
        Mood: todayColor.mood,
        Streak: streak.currentStreak + 1,
      });
    };

    // =============================================
    // POPULATE FORTUNE
    // =============================================
    function populateFortune() {
      const catIcon = icons[todayFortune.category] || 'ğŸŒ¿';
      const catLabel = todayFortune.category.replace(/-/g, ' ');
      document.getElementById('fCategory').innerHTML = `${catIcon} <span style="text-transform:capitalize">${catLabel}</span>`;

      document.getElementById('fTextEn').textContent = todayFortune.en;
      document.getElementById('fTextZh').textContent = todayFortune.zh;

      // Streak count bumps by 1 on fresh reveal
      document.getElementById('streakCount2').textContent = streak.currentStreak + 1;

      // Lucky number
      document.getElementById('wLucky').textContent = luckyNumber;

      // Color
      document.getElementById('wColorIcon').innerHTML = `<span class="color-swatch" style="background:${todayColor.hex}"></span>`;
      document.getElementById('wColorName').textContent = todayColor.name.split(' ').pop();

      // Mood
      document.getElementById('wMood').textContent = todayColor.mood;

      // Share card
      document.getElementById('scFortune').textContent = todayFortune.en;
      document.getElementById('scFortuneZh').textContent = todayFortune.zh;
      document.getElementById('scColor').innerHTML = `<span class="color-swatch" style="background:${todayColor.hex};width:12px;height:12px"></span>`;
      document.getElementById('scColorName').textContent = todayColor.name;
      document.getElementById('scLucky').textContent = luckyNumber;
      document.getElementById('scMood').textContent = todayColor.mood;
    }

    // =============================================
    // PARTICLE BURST (leaf-like scatter)
    // =============================================
    function burstParticles() {
      const canvas = document.getElementById('particleCanvas');
      const ctx = canvas.getContext('2d');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      const particles = [];
      const emojis = ['ğŸŒ¿', 'âœ¨', 'ğŸ’š', 'ğŸƒ', 'âœ¦'];

      for (let i = 0; i < 18; i++) {
        particles.push({
          x: canvas.width / 2 + (Math.random() - 0.5) * 40,
          y: canvas.height / 2,
          vx: (Math.random() - 0.5) * 8,
          vy: (Math.random() - 0.5) * 8 - 2,
          size: 12 + Math.random() * 14,
          emoji: emojis[Math.floor(Math.random() * emojis.length)],
          rotation: Math.random() * 360,
          rotSpeed: (Math.random() - 0.5) * 6,
          life: 1,
          decay: 0.012 + Math.random() * 0.008,
          gravity: 0.08,
        });
      }

      function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        let alive = false;

        particles.forEach(p => {
          if (p.life <= 0) return;
          alive = true;
          p.x += p.vx;
          p.y += p.vy;
          p.vy += p.gravity;
          p.vx *= 0.98;
          p.rotation += p.rotSpeed;
          p.life -= p.decay;

          ctx.save();
          ctx.translate(p.x, p.y);
          ctx.rotate(p.rotation * Math.PI / 180);
          ctx.globalAlpha = Math.max(0, p.life);
          ctx.font = `${p.size}px serif`;
          ctx.textAlign = 'center';
          ctx.textBaseline = 'middle';
          ctx.fillText(p.emoji, 0, 0);
          ctx.restore();
        });

        if (alive) requestAnimationFrame(animate);
        else ctx.clearRect(0, 0, canvas.width, canvas.height);
      }
      requestAnimationFrame(animate);
    }

    // =============================================
    // SHARE
    // =============================================
    window.showShareCard = function () {
      document.getElementById('shareBackdrop').classList.add('show');
      document.getElementById('shareCard').classList.add('show');
    };

    window.showShareCardFromAO = function () {
      // Populate share card from already-opened state
      document.getElementById('scFortune').textContent = todayFortune.en;
      document.getElementById('scFortuneZh').textContent = todayFortune.zh;
      document.getElementById('scColor').innerHTML = '<span class="color-swatch" style="background:' + todayColor.hex + ';width:12px;height:12px"></span>';
      document.getElementById('scColorName').textContent = todayColor.name;
      document.getElementById('scLucky').textContent = luckyNumber;
      document.getElementById('scMood').textContent = todayColor.mood;
      showShareCard();
    };

    window.hideShareCard = function () {
      document.getElementById('shareCard').classList.remove('show');
      setTimeout(() => document.getElementById('shareBackdrop').classList.remove('show'), 300);
    };

    window.shareNow = function () {
      const text = `ğŸŒ¿ My Evercare Wellness Fortune:\n\n"${todayFortune.en}"\n${todayFortune.zh}\n\nğŸ”¢ Lucky No. ${luckyNumber} Â· ğŸ¨ ${todayColor.name} Â· ğŸ§˜ ${todayColor.mood}\nğŸ”¥ ${streak.currentStreak + 1}-day streak\n\nEvercare Â· Family First\nyourevercare.com`;

      pushEvent(CONFIG.events.fortuneShared, {
        Fortune_EN: todayFortune.en,
        Category: todayFortune.category,
      });

      if (navigator.share) {
        navigator.share({ text }).catch(() => {});
      } else {
        try {
          const ta = document.createElement('textarea');
          ta.value = text; ta.style.cssText = 'position:fixed;opacity:0';
          document.body.appendChild(ta); ta.select();
          document.execCommand('copy');
          document.body.removeChild(ta);
        } catch (e) {}
      }
      hideShareCard();
    };

    // =============================================
    // ACTIONS
    // =============================================
    window.ctaClick = function () {
      pushEvent(CONFIG.events.fortuneCta, {
        Fortune_Index: fortuneIndex,
        Category: todayFortune.category,
      });
      if (CONFIG.cta.url) window.location.href = CONFIG.cta.url;
    };

    window.dismiss = function () {
      pushEvent(CONFIG.events.fortuneDismissed, {
        Revealed: revealed,
        Fortune_Index: revealed ? fortuneIndex : null,
      });
      try {
        if (typeof CleverTap !== 'undefined' && CleverTap.dismissInAppNotification) {
          CleverTap.dismissInAppNotification(); return;
        }
      } catch (e) {}
      window.location.href = 'wzrk://exit';
    };

    // =============================================
    // CLEVERTAP
    // =============================================
    function pushEvent(name, props) {
      const payload = props || {};
      payload.Timestamp = new Date().toISOString();
      try {
        if (typeof CleverTap !== 'undefined' && CleverTap.pushEvent)
          CleverTap.pushEvent(name, JSON.stringify(payload));
        if (typeof clevertap !== 'undefined' && clevertap.event)
          clevertap.event.push(name, payload);
        if (window.webkit?.messageHandlers?.clevertap)
          window.webkit.messageHandlers.clevertap.postMessage(JSON.stringify({ type: 'event', name, props: payload }));
      } catch (e) { console.log('[CT]', name, payload); }
    }

    // =============================================
    // ğŸ§ª TEST PANEL CONTROLS
    // =============================================
    const currentTestDay = forcedIndex !== null ? forcedIndex : (dayOfYear % fortunes.length);

    // Show test panel if ?test=true
    if (urlParams.get('test') === 'true') {
      document.getElementById('testPanel').classList.add('show');
      document.getElementById('tpInfo').textContent = fortuneIndex + ' / ' + fortunes.length;
    }

    function getTestParams() {
      // Preserve existing params
      const p = new URLSearchParams(window.location.search);
      return p;
    }

    window.testNav = function (dir) {
      const p = getTestParams();
      const cur = parseInt(p.get('day') || currentTestDay, 10);
      const next = ((cur + dir) % fortunes.length + fortunes.length) % fortunes.length;
      p.set('day', next);
      p.set('test', 'true');
      p.delete('revealed');
      window.location.search = p.toString();
    };

    window.testGo = function (idx) {
      const p = getTestParams();
      p.set('day', idx);
      p.set('test', 'true');
      p.delete('revealed');
      window.location.search = p.toString();
    };

    window.testRevealed = function () {
      const p = getTestParams();
      p.set('revealed', 'true');
      p.set('test', 'true');
      window.location.search = p.toString();
    };

    window.testStreak = function (n) {
      const p = getTestParams();
      p.set('streak', n);
      p.set('best', Math.max(n, 12));
      p.set('test', 'true');
      p.delete('revealed');
      window.location.search = p.toString();
    };
  </script>
</body>
</html>
